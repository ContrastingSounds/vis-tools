!function(e){var t={};function s(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t){class s{constructor({vis:e,queryResponseField:t}){this.vis=e,this.name=t.name,this.view=t.view_label||"",this.label=t.field_group_variant||t.label_short||t.label,this.is_numeric=void 0!==t.is_numeric&&t.is_numeric,this.is_array=["list","number_list","location","tier"].includes(t.type),this.value_format=t.value_format?t.value_format:"",this.geo_type="",("location"===t.type||t.map_layer)&&(this.geo_type="location"===t.type?"location":t.map_layer.name),this.hide=!1,void 0!==this.vis.config["hide|"+this.name]&&this.vis.config["hide|"+this.name]&&(this.hide=!0),this.style="";var s=this.vis.config["style|"+this.name];void 0!==s&&("hide"===s?this.hide=!0:this.style=s),this.heading="",this.short_name="",this.unit="",void 0!==t.tags&&t.tags.forEach(e=>{var t=e.split(":");if("vis-tools"===t[0])switch(t[1]){case"heading":this.heading=t[2];break;case"short_name":this.short_name=t[2];break;case"unit":this.unit=t[2];break;case"style":this.style=t[2]}})}}class a{constructor({keys:e,values:t,types:s=[]}){if(e.length===t.length){this.keys=e,this.values=t,this.types=s;var a=[],i=[];this.values.forEach((e,t)=>{this.types[t]=void 0!==s[t]?s[t]:"line_item","line_item"===this.types[t]?(a.push(e),i.push(e)):"subtotal"===this.types[t]&&i.push(e)}),this.min_for_display=Math.min(...i),this.max_for_display=Math.max(...i),this.min=Math.min(...a),this.max=Math.max(...a),this.sum=a.reduce((e,t)=>e+t,0),this.count=a.length,this.avg=a.length>0?this.sum/a.length:null}else console.log("Could not construct series, arrays were of different length.")}}t.newArray=function(e,t){for(var s=[],a=0;a<e;a++)s.push(t);return s},t.ModelDimension=class extends s{constructor({vis:e,queryResponseField:t}){super({vis:e,queryResponseField:t}),this.type="dimension",this.align="left"}},t.ModelPivot=class extends s{constructor({vis:e,queryResponseField:t}){super({vis:e,queryResponseField:t}),this.type="pivot",this.align="center"}},t.ModelMeasure=class extends s{constructor({vis:e,queryResponseField:t,can_pivot:s}){super({vis:e,queryResponseField:t}),this.type="measure",this.align="right",this.is_table_calculation=void 0!==t.is_table_calculation&&t.is_table_calculation,this.calculation_type=t.type,this.is_turtle=void 0!==t.is_turtle&&t.is_turtle,this.can_pivot=s}},t.CellSeries=class{constructor({column:e,row:t,sort_value:s,series:i}){this.column=e,this.row=t,this.sort_value=s,this.series=new a(i)}toString(){var e="";return this.series.keys.forEach((t,s)=>{e+=t+":";var a=""===this.column.modelField.value_format?this.series.values[s].toString():SSF.format(this.column.modelField.value_format,this.series.values[s]);e+=a+" "}),e}},t.ColumnSeries=class{constructor({column:e,is_numeric:t,series:s}){this.column=e,this.is_numeric=t,this.series=new a(s)}},t.HeaderCell=class{constructor({vis:e,type:t,modelField:s={name:"",label:"",view:""},pivotData:a={}}={vis:e,type:t,modelField:s,pivotData:a}){this.vis=e,this.type=t,this.modelField=s,this.pivotData=a}},t.DataCell=class{constructor({value:e,rendered:t=null,html:s=null,links:a=[],cell_style:i=[],align:l="right",rowid:r="",colid:n="",rowspan:o=1}={}){this.value=e,this.rendered=t,this.html=s,this.links=a,this.cell_style=i,this.align=l,this.rowid=r,this.colid=n,this.rowspan=o}},t.Row=class{constructor(e="line_item"){this.id="",this.hide=!1,this.type=e,this.sort=[],this.data={}}},t.Column=class{constructor(e,t,s){this.id=e,this.vis=t,this.modelField=s,this.transposed=!1,this.idx=0,this.pos=0,this.levels=[],this.pivot_key="",this.unit=s.unit||"",this.hide=s.hide||!1,this.variance_type="",this.pivoted=!1,this.subtotal=!1,this.super=!1,this.series=null,this.sort_by_measure_values=[],this.sort_by_pivot_values=[],this.colspans=[];var a={};this.vis.headers.forEach(e=>{a[e.type]=1}),this.vis.colspan_values[this.id]=a}getLabel(e){var t=this.levels[e],s=t.modelField.label,a=this.vis.config["heading|"+t.modelField.name],i=this.vis.config["label|"+t.modelField.name];if("heading"===t.type)return s=void 0!==a&&a||t.modelField.heading;if("field"===t.type){if(void 0!==this.vis.visId&&"report_table"===this.vis.visId)switch(this.variance_type){case"absolute":s="Var #";break;case"percentage":s="Var %";break;default:s=this.vis.useShortName&&t.modelField.short_name||t.modelField.label}void 0!==i&&i!==this.modelField.label&&(s=i||s),void 0!==this.vis.useViewName&&this.vis.useViewName&&(s=[this.modelField.view,s].join(" "))}return s}getHeaderLevels(){if("getSortByPivots"===this.modelField.vis.sortColsBy)var e=[...this.levels,this.getLabel(this.levels.length)];else e=[this.getLabel(0),...this.levels];if(this.modelField.vis.useHeadings&&!this.modelField.vis.has_pivots){var t=this.modelField.heading,s=this.modelField.vis.config["heading|"+this.modelField.name];void 0!==s&&(t=s||t),e.unshift(t)}return e}getHeaderData(){var e={};return this.modelField.vis.headers.forEach((t,s)=>{e[t.type]=this.levels[s]}),e}updateSortByMeasures(e){1==this.sort_by_measure_values[0]&&(this.pivoted||this.subtotal||(this.sort_by_measure_values=[1,e]))}getSortByMeasures(){return this.sort_by_measure_values}getSortByPivots(){return this.sort_by_pivot_values}}},function(e,t,s){var a={};!function(e){function t(e){for(var t="",s=e.length-1;s>=0;)t+=e.charAt(s--);return t}function s(e,t){for(var s="";s.length<t;)s+=e;return s}function a(e,t){var a=""+e;return a.length>=t?a:s("0",t-a.length)+a}function i(e,t){var a=""+e;return a.length>=t?a:s(" ",t-a.length)+a}function l(e,t){var a=""+e;return a.length>=t?a:a+s(" ",t-a.length)}e.version="0.11.0";var r=Math.pow(2,32);function n(e,t){return e>r||e<-r?function(e,t){var a=""+Math.round(e);return a.length>=t?a:s("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:s("0",t-a.length)+a}(Math.round(e),t)}function o(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var h=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],d=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var c={};function v(e,t,s){for(var a=e<0?-1:1,i=e*a,l=0,r=1,n=0,o=1,h=0,d=0,u=Math.floor(i);h<t&&(n=(u=Math.floor(i))*r+l,d=u*h+o,!(i-u<5e-8));)i=1/(i-u),l=r,r=n,o=h,h=d;if(d>t&&(h>t?(d=o,n=l):(d=h,n=r)),!s)return[0,a*n,d];var c=Math.floor(a*n/d);return[c,a*n-c*d,d]}function p(e,t,s){if(e>2958465||e<0)return null;var a=0|e,i=Math.floor(86400*(e-a)),l=0,r=[],n={D:a,T:i,u:86400*(e-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(n.u)<1e-6&&(n.u=0),t&&t.date1904&&(a+=1462),n.u>.9999&&(n.u=0,86400==++i&&(n.T=i=0,++a,++n.D)),60===a)r=s?[1317,10,29]:[1900,2,29],l=3;else if(0===a)r=s?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),r=[o.getFullYear(),o.getMonth()+1,o.getDate()],l=o.getDay(),a<60&&(l=(l+6)%7),s&&(l=0)}return n.y=r[0],n.m=r[1],n.d=r[2],n.S=i%60,i=Math.floor(i/60),n.M=i%60,i=Math.floor(i/60),n.H=i,n.q=l,n}u(c),e.parse_date_code=p;var m=new Date(1899,11,31,0,0,0),f=m.getTime(),b=new Date(1900,2,1,0,0,0);function g(e,t){var s=e.getTime();return t?s-=1262304e5:e>=b&&(s+=864e5),(s-(f+6e4*(e.getTimezoneOffset()-m.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var _=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,s=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,i=/(E[+-])(\d)$/;function l(s){return s.indexOf(".")>-1?s.replace(t,"").replace(e,".$1"):s}return function(t){var r,n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return r=n>=-4&&n<=-1?t.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,s=l(e.toFixed(12));return s.length<=t||(s=e.toPrecision(10)).length<=t?s:e.toExponential(5)}(t):10===n?t.toFixed(10).substr(0,12):function(t){var s=t.toFixed(11).replace(e,".$1");return s.length>(t<0?12:11)&&(s=t.toPrecision(6)),s}(t),l(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(s,".$1").replace(a,"E").replace("e","E").replace(i,"$10$2");return e}(r))}}();function y(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):_(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return S(14,g(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function w(e,t,s,i){var l,r="",n=0,o=0,u=s.y,c=0;switch(e){case 98:u=s.y+543;case 121:switch(t.length){case 1:case 2:l=u%100,c=2;break;default:l=u%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:l=s.m,c=t.length;break;case 3:return d[s.m-1][1];case 5:return d[s.m-1][0];default:return d[s.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=s.d,c=t.length;break;case 3:return h[s.q][0];default:return h[s.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(s.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=s.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=s.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==s.u||"s"!=t&&"ss"!=t?(o=i>=2?3===i?1e3:100:1===i?10:1,(n=Math.round(o*(s.S+s.u)))>=60*o&&(n=0),"s"===t?0===n?"0":""+n/o:(r=a(n,2+i),"ss"===t?r.substr(0,2):"."+r.substr(2,t.length-1))):a(s.S,t.length);case 90:switch(t){case"[h]":case"[hh]":l=24*s.D+s.H;break;case"[m]":case"[mm]":l=60*(24*s.D+s.H)+s.M;break;case"[s]":case"[ss]":l=60*(60*(24*s.D+s.H)+s.M)+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:l=u,c=1}return c>0?a(l,c):""}function $(e){if(e.length<=3)return e;for(var t=e.length%3,s=e.substr(0,t);t!=e.length;t+=3)s+=(s.length>0?",":"")+e.substr(t,3);return s}e._general_num=_,e._general=y;var C=function(){var e=/%/g;var r=/# (\?+)( ?)\/( ?)(\d+)/;var o=/^#*0*\.([0#]+)/,h=/\).*[0#]/,d=/\(###\) ###\\?-####/;function u(e){for(var t,s="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(t)}return s}function c(e,t){var s=Math.pow(10,t);return""+Math.round(e*s)/s}function p(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function m(f,b,g){if(40===f.charCodeAt(0)&&!b.match(h)){var _=b.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return g>=0?m("n",_,g):"("+m("n",_,-g)+")"}if(44===b.charCodeAt(b.length-1))return function(e,t,s){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return C(e,t.substr(0,a),s/Math.pow(10,3*(t.length-a)))}(f,b,g);if(-1!==b.indexOf("%"))return function(t,a,i){var l=a.replace(e,""),r=a.length-l.length;return C(t,l,i*Math.pow(10,2*r))+s("%",r)}(f,b,g);if(-1!==b.indexOf("E"))return function e(t,s){var a,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+e(t,-s);var l=t.indexOf(".");-1===l&&(l=t.indexOf("E"));var r=Math.floor(Math.log(s)*Math.LOG10E)%l;if(r<0&&(r+=l),-1===(a=(s/Math.pow(10,r)).toPrecision(i+1+(l+r)%l)).indexOf("e")){var n=Math.floor(Math.log(s)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(n-a.length+r):a+="E+"+(n-r);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,l)+"."+a.substr(2+l)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,s,a){return t+s+a.substr(0,(l+r)%l)+"."+a.substr(r)+"E"}))}else a=s.toExponential(i);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(b,g);if(36===b.charCodeAt(0))return"$"+m(f,b.substr(" "==b.charAt(1)?2:1),g);var y,w,F,M,k=Math.abs(g),E=g<0?"-":"";if(b.match(/^00+$/))return E+n(k,b.length);if(b.match(/^[#?]+$/))return"0"===(y=n(g,0))&&(y=""),y.length>b.length?y:u(b.substr(0,b.length-y.length))+y;if(w=b.match(r))return function(e,t,l){var r=parseInt(e[4],10),n=Math.round(t*r),o=Math.floor(n/r),h=n-o*r,d=r;return l+(0===o?"":""+o)+" "+(0===h?s(" ",e[1].length+1+e[4].length):i(h,e[1].length)+e[2]+"/"+e[3]+a(d,e[4].length))}(w,k,E);if(b.match(/^#+0+$/))return E+n(k,b.length-b.indexOf("0"));if(w=b.match(o))return y=c(g,w[1].length).replace(/^([^\.]+)$/,"$1."+u(w[1])).replace(/\.$/,"."+u(w[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+s("0",u(w[1]).length-t.length)})),-1!==b.indexOf("0.")?y:y.replace(/^0\./,".");if(b=b.replace(/^#+([0.])/,"$1"),w=b.match(/^(0*)\.(#*)$/))return E+c(k,w[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,w[1].length?"0.":".");if(w=b.match(/^#{1,3},##0(\.?)$/))return E+$(n(k,0));if(w=b.match(/^#,##0\.([#0]*0)$/))return g<0?"-"+m(f,b,-g):$(""+(Math.floor(g)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(g,w[1].length)))+"."+a(p(g,w[1].length),w[1].length);if(w=b.match(/^#,#*,#0/))return m(f,b.replace(/^#,#*,/,""),g);if(w=b.match(/^([0#]+)(\\?-([0#]+))+$/))return y=t(m(f,b.replace(/[\\-]/g,""),g)),F=0,t(t(b.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return F<y.length?y.charAt(F++):"0"===e?"0":""})));if(b.match(d))return"("+(y=m(f,"##########",g)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var x="";if(w=b.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return F=Math.min(w[4].length,7),M=v(k,Math.pow(10,F)-1,!1),y=""+E," "==(x=C("n",w[1],M[1])).charAt(x.length-1)&&(x=x.substr(0,x.length-1)+"0"),y+=x+w[2]+"/"+w[3],(x=l(M[2],F)).length<w[4].length&&(x=u(w[4].substr(w[4].length-x.length))+x),y+=x;if(w=b.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return F=Math.min(Math.max(w[1].length,w[4].length),7),E+((M=v(k,Math.pow(10,F)-1,!0))[0]||(M[1]?"":"0"))+" "+(M[1]?i(M[1],F)+w[2]+"/"+w[3]+l(M[2],F):s(" ",2*F+1+w[2].length+w[3].length));if(w=b.match(/^[#0?]+$/))return y=n(g,0),b.length<=y.length?y:u(b.substr(0,b.length-y.length))+y;if(w=b.match(/^([#0?]+)\.([#0]+)$/)){y=""+g.toFixed(Math.min(w[2].length,10)).replace(/([^0])0+$/,"$1"),F=y.indexOf(".");var A=b.indexOf(".")-F,O=b.length-y.length-A;return u(b.substr(0,A)+y+b.substr(b.length-O))}if(w=b.match(/^00,000\.([#0]*0)$/))return F=p(g,w[1].length),g<0?"-"+m(f,b,-g):$(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(g)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(F,w[1].length);switch(b){case"###,##0.00":return m(f,"#,##0.00",g);case"###,###":case"##,###":case"#,###":var S=$(n(k,0));return"0"!==S?E+S:"";case"###,###.00":return m(f,"###,##0.00",g).replace(/^0\./,".");case"#,###.00":return m(f,"#,##0.00",g).replace(/^0\./,".")}throw new Error("unsupported format |"+b+"|")}function f(n,c,p){if(40===n.charCodeAt(0)&&!c.match(h)){var m=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?f("n",m,p):"("+f("n",m,-p)+")"}if(44===c.charCodeAt(c.length-1))return function(e,t,s){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return C(e,t.substr(0,a),s/Math.pow(10,3*(t.length-a)))}(n,c,p);if(-1!==c.indexOf("%"))return function(t,a,i){var l=a.replace(e,""),r=a.length-l.length;return C(t,l,i*Math.pow(10,2*r))+s("%",r)}(n,c,p);if(-1!==c.indexOf("E"))return function e(t,s){var a,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+e(t,-s);var l=t.indexOf(".");-1===l&&(l=t.indexOf("E"));var r=Math.floor(Math.log(s)*Math.LOG10E)%l;if(r<0&&(r+=l),!(a=(s/Math.pow(10,r)).toPrecision(i+1+(l+r)%l)).match(/[Ee]/)){var n=Math.floor(Math.log(s)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(n-a.length+r):a+="E+"+(n-r),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,s,a){return t+s+a.substr(0,(l+r)%l)+"."+a.substr(r)+"E"}))}else a=s.toExponential(i);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(c,p);if(36===c.charCodeAt(0))return"$"+f(n,c.substr(" "==c.charAt(1)?2:1),p);var b,g,_,y,w=Math.abs(p),F=p<0?"-":"";if(c.match(/^00+$/))return F+a(w,c.length);if(c.match(/^[#?]+$/))return b=""+p,0===p&&(b=""),b.length>c.length?b:u(c.substr(0,c.length-b.length))+b;if(g=c.match(r))return function(e,t,a){return a+(0===t?"":""+t)+s(" ",e[1].length+2+e[4].length)}(g,w,F);if(c.match(/^#+0+$/))return F+a(w,c.length-c.indexOf("0"));if(g=c.match(o))return b=(b=(""+p).replace(/^([^\.]+)$/,"$1."+u(g[1])).replace(/\.$/,"."+u(g[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+s("0",u(g[1]).length-t.length)})),-1!==c.indexOf("0.")?b:b.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),g=c.match(/^(0*)\.(#*)$/))return F+(""+w).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,g[1].length?"0.":".");if(g=c.match(/^#{1,3},##0(\.?)$/))return F+$(""+w);if(g=c.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+f(n,c,-p):$(""+p)+"."+s("0",g[1].length);if(g=c.match(/^#,#*,#0/))return f(n,c.replace(/^#,#*,/,""),p);if(g=c.match(/^([0#]+)(\\?-([0#]+))+$/))return b=t(f(n,c.replace(/[\\-]/g,""),p)),_=0,t(t(c.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return _<b.length?b.charAt(_++):"0"===e?"0":""})));if(c.match(d))return"("+(b=f(n,"##########",p)).substr(0,3)+") "+b.substr(3,3)+"-"+b.substr(6);var M="";if(g=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(g[4].length,7),y=v(w,Math.pow(10,_)-1,!1),b=""+F," "==(M=C("n",g[1],y[1])).charAt(M.length-1)&&(M=M.substr(0,M.length-1)+"0"),b+=M+g[2]+"/"+g[3],(M=l(y[2],_)).length<g[4].length&&(M=u(g[4].substr(g[4].length-M.length))+M),b+=M;if(g=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(g[1].length,g[4].length),7),F+((y=v(w,Math.pow(10,_)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?i(y[1],_)+g[2]+"/"+g[3]+l(y[2],_):s(" ",2*_+1+g[2].length+g[3].length));if(g=c.match(/^[#0?]+$/))return b=""+p,c.length<=b.length?b:u(c.substr(0,c.length-b.length))+b;if(g=c.match(/^([#0]+)\.([#0]+)$/)){b=""+p.toFixed(Math.min(g[2].length,10)).replace(/([^0])0+$/,"$1"),_=b.indexOf(".");var k=c.indexOf(".")-_,E=c.length-b.length-k;return u(c.substr(0,k)+b+c.substr(c.length-E))}if(g=c.match(/^00,000\.([#0]*0)$/))return p<0?"-"+f(n,c,-p):$(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,g[1].length);switch(c){case"###,###":case"##,###":case"#,###":var x=$(""+w);return"0"!==x?F+x:"";default:if(c.match(/\.[0#?]*$/))return f(n,c.slice(0,c.lastIndexOf(".")),p)+u(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}return function(e,t,s){return(0|s)===s?f(e,t,s):m(e,t,s)}}();function F(e){for(var t=[],s=!1,a=0,i=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(i,a-i),i=a+1}if(t[t.length]=e.substr(i),!0===s)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=F;var M=/\[[HhMmSs]*\]/;function k(e){for(var t=0,s="",a="";t<e.length;)switch(s=e.charAt(t)){case"G":o(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=s;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(M))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++t))>-1||"\\"==s&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===s;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function E(e,t,s,a){for(var i,l,r,n=[],h="",d=0,u="",c="t",v="H";d<e.length;)switch(u=e.charAt(d)){case"G":if(!o(e,d))throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"G",v:"General"},d+=7;break;case'"':for(h="";34!==(r=e.charCodeAt(++d))&&d<e.length;)h+=String.fromCharCode(r);n[n.length]={t:"t",v:h},++d;break;case"\\":var m=e.charAt(++d),f="("===m||")"===m?m:"t";n[n.length]={t:f,v:m},++d;break;case"_":n[n.length]={t:"t",v:" "},d+=2;break;case"@":n[n.length]={t:"T",v:t},++d;break;case"B":case"b":if("1"===e.charAt(d+1)||"2"===e.charAt(d+1)){if(null==i&&null==(i=p(t,s,"2"===e.charAt(d+1))))return"";n[n.length]={t:"X",v:e.substr(d,2)},c=u,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=p(t,s)))return"";for(h=u;++d<e.length&&e.charAt(d).toLowerCase()===u;)h+=u;"m"===u&&"h"===c.toLowerCase()&&(u="M"),"h"===u&&(u=v),n[n.length]={t:u,v:h},c=u;break;case"A":case"a":var b={t:u,v:u};if(null==i&&(i=p(t,s)),"A/P"===e.substr(d,3).toUpperCase()?(null!=i&&(b.v=i.H>=12?"P":"A"),b.t="T",v="h",d+=3):"AM/PM"===e.substr(d,5).toUpperCase()?(null!=i&&(b.v=i.H>=12?"PM":"AM"),b.t="T",d+=5,v="h"):(b.t="t",++d),null==i&&"T"===b.t)return"";n[n.length]=b,c=u;break;case"[":for(h=u;"]"!==e.charAt(d++)&&d<e.length;)h+=e.charAt(d);if("]"!==h.slice(-1))throw'unterminated "[" block: |'+h+"|";if(h.match(M)){if(null==i&&null==(i=p(t,s)))return"";n[n.length]={t:"Z",v:h.toLowerCase()},c=h.charAt(1)}else h.indexOf("$")>-1&&(h=(h.match(/\$([^-\[\]]*)/)||[])[1]||"$",k(e)||(n[n.length]={t:"t",v:h}));break;case".":if(null!=i){for(h=u;++d<e.length&&"0"===(u=e.charAt(d));)h+=u;n[n.length]={t:"s",v:h};break}case"0":case"#":for(h=u;++d<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(d))>-1;)h+=u;n[n.length]={t:"n",v:h};break;case"?":for(h=u;e.charAt(++d)===u;)h+=u;n[n.length]={t:u,v:h},c=u;break;case"*":++d," "!=e.charAt(d)&&"*"!=e.charAt(d)||++d;break;case"(":case")":n[n.length]={t:1===a?"t":u,v:u},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(h=u;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)h+=e.charAt(d);n[n.length]={t:"D",v:h};break;case" ":n[n.length]={t:u,v:u},++d;break;case"$":n[n.length]={t:"t",v:"$"},++d;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"t",v:u},++d}var g,_=0,$=0;for(d=n.length-1,c="t";d>=0;--d)switch(n[d].t){case"h":case"H":n[d].t=v,c="h",_<1&&(_=1);break;case"s":(g=n[d].v.match(/\.0+$/))&&($=Math.max($,g[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=n[d].t;break;case"m":"s"===c&&(n[d].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&n[d].v.match(/[Hh]/)&&(_=1),_<2&&n[d].v.match(/[Mm]/)&&(_=2),_<3&&n[d].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var F,E="";for(d=0;d<n.length;++d)switch(n[d].t){case"t":case"T":case" ":case"D":break;case"X":n[d].v="",n[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[d].v=w(n[d].t.charCodeAt(0),n[d].v,i,$),n[d].t="t";break;case"n":case"?":for(F=d+1;null!=n[F]&&("?"===(u=n[F].t)||"D"===u||(" "===u||"t"===u)&&null!=n[F+1]&&("?"===n[F+1].t||"t"===n[F+1].t&&"/"===n[F+1].v)||"("===n[d].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===n[F].v||" "===n[F].v&&null!=n[F+1]&&"?"==n[F+1].t));)n[d].v+=n[F].v,n[F]={v:"",t:";"},++F;E+=n[d].v,d=F-1;break;case"G":n[d].t="t",n[d].v=y(t,s)}var x,A,O="";if(E.length>0){40==E.charCodeAt(0)?(x=t<0&&45===E.charCodeAt(0)?-t:t,A=C("n",E,x)):(A=C("n",E,x=t<0&&a>1?-t:t),x<0&&n[0]&&"t"==n[0].t&&(A=A.substr(1),n[0].v="-"+n[0].v)),F=A.length-1;var S=n.length;for(d=0;d<n.length;++d)if(null!=n[d]&&"t"!=n[d].t&&n[d].v.indexOf(".")>-1){S=d;break}var H=n.length;if(S===n.length&&-1===A.indexOf("E")){for(d=n.length-1;d>=0;--d)null!=n[d]&&-1!=="n?".indexOf(n[d].t)&&(F>=n[d].v.length-1?(F-=n[d].v.length,n[d].v=A.substr(F+1,n[d].v.length)):F<0?n[d].v="":(n[d].v=A.substr(0,F+1),F=-1),n[d].t="t",H=d);F>=0&&H<n.length&&(n[H].v=A.substr(0,F+1)+n[H].v)}else if(S!==n.length&&-1===A.indexOf("E")){for(F=A.indexOf(".")-1,d=S;d>=0;--d)if(null!=n[d]&&-1!=="n?".indexOf(n[d].t)){for(l=n[d].v.indexOf(".")>-1&&d===S?n[d].v.indexOf(".")-1:n[d].v.length-1,O=n[d].v.substr(l+1);l>=0;--l)F>=0&&("0"===n[d].v.charAt(l)||"#"===n[d].v.charAt(l))&&(O=A.charAt(F--)+O);n[d].v=O,n[d].t="t",H=d}for(F>=0&&H<n.length&&(n[H].v=A.substr(0,F+1)+n[H].v),F=A.indexOf(".")+1,d=S;d<n.length;++d)if(null!=n[d]&&(-1!=="n?(".indexOf(n[d].t)||d===S)){for(l=n[d].v.indexOf(".")>-1&&d===S?n[d].v.indexOf(".")+1:0,O=n[d].v.substr(0,l);l<n[d].v.length;++l)F<A.length&&(O+=A.charAt(F++));n[d].v=O,n[d].t="t",H=d}}}for(d=0;d<n.length;++d)null!=n[d]&&"n?".indexOf(n[d].t)>-1&&(x=a>1&&t<0&&d>0&&"-"===n[d-1].v?-t:t,n[d].v=C(n[d].t,n[d].v,x),n[d].t="t");var T="";for(d=0;d!==n.length;++d)null!=n[d]&&(T+=n[d].v);return T}e.is_date=k,e._eval=E;var x=/\[[=<>]/,A=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function O(e,t){if(null==t)return!1;var s=parseFloat(t[2]);switch(t[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0}return!1}function S(e,t,s){null==s&&(s={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&s.dateNF?s.dateNF:e;break;case"number":a=14==e&&s.dateNF?s.dateNF:(null!=s.table?s.table:c)[e]}if(o(a,0))return y(t,s);t instanceof Date&&(t=g(t,s.date1904));var i=function(e,t){var s=F(e),a=s.length,i=s[a-1].indexOf("@");if(a<4&&i>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if("number"!=typeof t)return[4,4===s.length||i>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=i>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=i>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=i>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"]}var l=t>0?s[0]:t<0?s[1]:s[2];if(-1===s[0].indexOf("[")&&-1===s[1].indexOf("["))return[a,l];if(null!=s[0].match(x)||null!=s[1].match(x)){var r=s[0].match(A),n=s[1].match(A);return O(t,r)?[a,s[0]]:O(t,n)?[a,s[1]]:[a,s[null!=r&&null!=n?2:1]]}return[a,l]}(a,t);if(o(i[1]))return y(t,s);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return E(i[1],t,s,i[0])}function H(e,t){if("number"!=typeof t){t=+t||-1;for(var s=0;s<392;++s)if(null!=c[s]){if(c[s]==e){t=s;break}}else t<0&&(t=s);t<0&&(t=391)}return c[t]=e,t}e.load=H,e._table=c,e.get_table=function(){return c},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&H(e[t],t)},e.init_table=u,e.format=S}(a),"undefined"==typeof DO_NOT_EXPORT_SSF&&(e.exports=a)},function(e,t,s){"use strict";s.r(t);var a=s(1),i=s.n(a),l=s(0);const r={theme:{section:"Theme",type:"string",display:"select",label:"Theme",values:[{Traditional:"traditional"},{Looker:"looker"},{Contemporary:"contemporary"},{"Use custom theme":"custom"}],default:"traditional",order:1},customTheme:{section:"Theme",type:"string",label:"Load custom CSS from:",default:"",order:2},layout:{section:"Theme",type:"string",display:"select",label:"Layout",values:[{Even:"fixed"},{Auto:"auto"}],default:"fixed",order:3},columnOrder:{},rowSubtotals:{section:"Table",type:"boolean",label:"Row Subtotals",display_size:"half",default:!1,order:1},colSubtotals:{section:"Table",type:"boolean",label:"Col Subtotals",display_size:"half",default:!1,order:2},spanRows:{section:"Table",type:"boolean",label:"Merge Dims",display_size:"half",default:!0,order:3},spanCols:{section:"Table",type:"boolean",label:"Merge Headers",display_size:"half",default:!0,order:4},sortColumnsBy:{section:"Table",type:"string",display:"select",label:"Sort Columns By",values:[{Pivots:"pivots"},{Measures:"measures"}],default:"pivots",order:6},useViewName:{section:"Table",type:"boolean",label:"Include View Name",default:!1,order:7},useHeadings:{section:"Table",type:"boolean",label:"Use Headings",default:!1,order:8},useShortName:{section:"Table",type:"boolean",label:"Use Short Name (from model tags)",default:!1,order:9},groupVarianceColumns:{section:"Table",type:"boolean",label:"Group Variance Columns After Pivots",default:!1,order:10},indexColumn:{section:"Dimensions",type:"boolean",label:"Use Last Field Only",default:!1,order:0},transposeTable:{section:"Table",type:"boolean",label:"Transpose",default:!1,order:100}};exports.VisPluginTableModel=class{constructor(e,t,s){this.visId="report_table",this.config=s,this.headers=[],this.dimensions=[],this.measures=[],this.columns=[],this.data=[],this.subtotals_data={},this.transposed_headers=[],this.transposed_columns=[],this.transposed_data=[],this.pivot_fields=[],this.pivot_values=void 0!==t.pivots?t.pivots:[],this.variances=[],this.column_series=[],this.firstVisibleDimension="",this.colspan_values={},this.rowspan_values={},this.useIndexColumn=s.indexColumn||!1,this.useHeadings=s.useHeadings||!1,this.useShortName=s.useShortName||!1,this.useViewName=s.useViewName||!1,this.addRowSubtotals=s.rowSubtotals||!1,this.addSubtotalDepth=parseInt(s.subtotalDepth)||this.dimensions.length-1,this.addColSubtotals=s.colSubtotals||!1,this.spanRows=s.spanRows,this.spanCols=s.spanCols,this.sortColsBy=s.sortColumnsBy||"pivots",this.groupVarianceColumns=s.groupVarianceColumns||!1,this.hasTotals=void 0!==t.totals_data,this.calculateOthers=void 0!==t.truncated&&t.truncated,this.hasSubtotals=void 0!==t.subtotals_data,this.hasRowTotals=t.has_row_totals||!1,this.hasPivots=void 0!==t.pivots,this.hasSupers=void 0!==t.fields.supermeasure_like&&Boolean(t.fields.supermeasure_like.length),this.transposeTable=s.transposeTable||!1;this.addPivotsAndHeaders(t),this.addDimensions(t,0),this.addMeasures(t,0),this.checkVarianceCalculations(),this.useIndexColumn&&this.addIndexColumn(t),this.hasSubtotals&&this.checkSubtotalsData(t),this.addRows(e),console.log("Table in progress:",this)}static getCoreConfigOptions(){return r}getConfigOptions(){var e=r,t=[];return this.dimensions.forEach((s,a)=>{if(e["label|"+s.name]={section:"Dimensions",type:"string",label:s.label,default:s.label,order:10*a+1},e["heading|"+s.name]={section:"Dimensions",type:"string",label:"Heading",default:"",order:10*a+2},e["hide|"+s.name]={section:"Dimensions",type:"boolean",label:"Hide",display_size:"third",default:!1,order:10*a+3},a<this.dimensions.length-1){var i={};i[s.label]=(a+1).toString(),t.push(i)}}),e.subtotalDepth={section:"Table",type:"string",label:"Sub Total Depth",display:"select",values:t,default:"1",order:5},this.measures.forEach((t,s)=>{e["label|"+t.name]={section:"Measures",type:"string",label:t.label,default:t.label,order:100+10*s+1},e["heading|"+t.name]={section:"Measures",type:"string",label:"Heading for "+t.label,default:"",order:100+10*s+2},e["style|"+t.name]={section:"Measures",type:"string",label:"Style",display:"select",values:[{Normal:"normal"},{"Black/Red":"black_red"},{Subtotal:"subtotal"},{Hidden:"hide"}],order:100+10*s+3};var a=[];if(t.can_pivot){var i=[];this.pivot_fields.forEach((e,t)=>{if(1===this.pivot_fields.length||1===t||this.config.colSubtotals){var s={};s["By "+e.label]=e.name,i.push(s)}}),a=a.concat(i)}this.measures.forEach((e,i)=>{var l=t.can_pivot===e.can_pivot||this.hasRowTotals&&!e.is_table_calculation;if(s!=i&&l){var r={};r["Vs. "+e.label]=e.name,a.push(r)}}),a.unshift({"(none)":"no_variance"}),e["comparison|"+t.name]={section:"Measures",type:"string",label:"Comparison",display:"select",values:a,order:100+10*s+5},e["switch|"+t.name]={section:"Measures",type:"boolean",label:"Switch",display_size:"third",default:!1,order:100+10*s+6},e["var_num|"+t.name]={section:"Measures",type:"boolean",label:"Var #",display_size:"third",default:!0,order:100+10*s+7},e["var_pct|"+t.name]={section:"Measures",type:"boolean",label:"Var %",display_size:"third",default:!1,order:100+10*s+8}}),e}addPivotsAndHeaders(e){e.fields.pivots.forEach((e,t)=>{var s=new l.ModelPivot({vis:this,queryResponseField:e});this.pivot_fields.push(s),this.headers.push(new l.HeaderCell({vis:this,type:"pivot"+t,modelField:s}))});var t=this.useHeadings?[new l.HeaderCell({vis:this,type:"heading",modelField:{label:"(will be replaced by header for column)s"}})]:[];t.push(new l.HeaderCell({vis:this,type:"field",modelField:{label:"(will be replaced by field for column)"}})),"pivots"===this.sortColsBy?this.headers.push(...t):this.headers.unshift(...t)}addDimensions(e,t){e.fields.dimension_like.forEach(e=>{var s=new l.ModelDimension({vis:this,queryResponseField:e});s.hide=!!this.useIndexColumn||s.hide,this.dimensions.push(s);var a=new l.Column(s.name,this,s);a.idx=t,this.headers.forEach(e=>{switch(e.type){case"pivot0":case"pivot1":var t=new l.ModelPivot({vis:this,queryResponseField:e.modelField});a.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:t}));break;case"heading":a.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:s}));break;case"field":a.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:s}))}}),a.sort_by_measure_values=[0,t,...Object(l.newArray)(this.pivot_fields.length,0)],a.sort_by_pivot_values=[0,...Object(l.newArray)(this.pivot_fields.length,0),t],this.columns.push(a),t+=10});for(var s=0;s<this.dimensions.length;s++){var a=this.dimensions[s];if(!a.hide){this.firstVisibleDimension=a.name;break}}}addMeasures(e,t){e.fields.measure_like.forEach(e=>{var t=new l.ModelMeasure({vis:this,queryResponseField:e,can_pivot:!0});this.measures.push(t)}),this.hasPivots?this.pivot_values.forEach(e=>{this.measures.forEach((s,a)=>{if("$$$_row_total_$$$"!=e.key||"$$$_row_total_$$$"==e.key&&0==s.is_table_calculation){var i=new l.Column([e.key,s.name].join("."),this,s);i.pivoted=!0,i.pivot_key=e.key,i.idx=t;var r=[];this.headers.forEach(t=>{switch(t.type){case"pivot0":case"pivot1":var a="$$$_row_total_$$$"===e.key?"(row total)":e.data[t.modelField.name];i.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{label:a},pivotData:e})),r.push(e.sort_values[t.name]);break;case"heading":i.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:s}));break;case"field":i.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:s}))}}),"$$$_row_total_$$$"!==e.key?(i.sort_by_measure_values=[1,a,...r],i.sort_by_pivot_values=[1,...r,t]):(i.super=!0,i.sort_by_measure_values=[2,a,...Object(l.newArray)(this.pivot_fields.length,0)],i.sort_by_pivot_values=[2,...Object(l.newArray)(this.pivot_fields.length,0),t]),this.columns.push(i),t+=10}})}):this.measures.forEach(e=>{var s=new l.Column(e.name,this,e);this.headers.forEach(t=>{switch(t.type){case"heading":s.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:e}));break;case"field":s.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:e}))}}),s.idx=t;try{void 0!==this.config.columnOrder[s.id]?s.pos=this.config.columnOrder[s.id]:s.pos=t}catch{s.pos=t}s.sort_by_measure_values=[1,s.pos],s.sort_by_pivot_values=[1,s.pos],this.columns.push(s),t+=10}),void 0!==e.fields.supermeasure_like&&e.fields.supermeasure_like.forEach(e=>{var s=new l.ModelMeasure({vis:this,queryResponseField:e,can_pivot:!1});this.measures.push(s);var a=new l.Column(s.name,this,s);this.headers.forEach(e=>{switch(e.type){case"pivot0":case"pivot1":a.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{label:"(supermeasure)"}}));break;case"heading":a.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:s}));break;case"field":a.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:s}))}}),a.idx=t,a.super=!0,a.sort_by_measure_values=[2,t,...Object(l.newArray)(this.pivot_fields.length,1)],a.sort_by_pivot_values=[2,...Object(l.newArray)(this.pivot_fields.length,1),t],this.columns.push(a),t+=10})}checkVarianceCalculations(){Object.keys(this.config).forEach(e=>{if(e.startsWith("comparison")){var t=e.split("|")[1],s=!1;if(this.measures.forEach(e=>{t===e.name&&(s=!0)}),s){if(this.pivot_fields.map(e=>e.name).includes(this.config[e]))var a="by_pivot";else a="no_variance"===this.config[e]?"no_variance":"vs_measure";if(void 0!==this.config["switch|"+t])if(this.config["switch|"+t])var i=!0;else i=!1;this.variances.push({baseline:t,comparison:this.config[e],type:a,reverse:i})}}})}addIndexColumn(){var e=this.dimensions[this.dimensions.length-1],t=new l.Column("$$$_index_$$$",this,e),s=this.config["hide|"+e.name];t.hide=!0===s&&s,this.headers.forEach(s=>{switch(s.type){case"pivot0":case"pivot1":var a=new l.ModelPivot({vis:this,queryResponseField:s.modelField});t.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:a}));break;case"heading":t.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:e}));break;case"field":t.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:e}))}}),t.sort_by_measure_values=[-1,0,...Object(l.newArray)(this.pivot_fields.length,0)],t.sort_by_pivot_values=[-1,...Object(l.newArray)(this.pivot_fields.length,0),0],this.columns.push(t)}checkSubtotalsData(e){void 0!==e.subtotals_data[this.addSubtotalDepth]&&e.subtotals_data[this.addSubtotalDepth].forEach(e=>{var t=new l.Row("subtotal");t.$$$__grouping__$$$=e.$$$__grouping__$$$;var s=["Subtotal"];t.$$$__grouping__$$$.forEach(t=>{s.push(e[t].value)}),t.id=s.join("|"),this.columns.forEach(s=>{t.data[s.id]=s.pivoted?e[s.modelField.name][s.pivot_key]:e[s.id],void 0!==t.data[s.id]&&(void 0===t.data[s.id].cell_style?t.data[s.id].cell_style=["total","subtotal"]:t.data[s.id].cell_style.concat(["total","subtotal"]),void 0!==s.modelField.style&&(t.data[s.id].cell_style=t.data[s.id].cell_style.concat(s.modelField.style)),null===t.data[s.id].value&&(t.data[s.id].rendered=""))}),this.subtotals_data[t.id]=t})}addRows(e){e.forEach((e,t)=>{var s=new l.Row("line_item");s.id=this.dimensions.map(t=>e[t.name].value).join("|"),this.columns.forEach(t=>{var a=t.pivoted?e[t.modelField.name][t.pivot_key]:e[t.id],i=new l.DataCell(a);if(i.rowid=s.id,i.colid=t.id,"dimension"===t.modelField.type&&(i.align="left"),void 0!==t.modelField.style&&(i.cell_style=i.cell_style.concat(t.modelField.style)),null===i.value&&(i.rendered=""),t.modelField.is_turtle){var r=new l.CellSeries({column:t,row:s,sort_value:i.sort_value,series:{keys:s.data[t.id]._parsed.keys,values:s.data[t.id]._parsed.values}});i.value=r,i.rendered=r.toString()}s.data[t.id]=i});var a=this.dimensions[this.dimensions.length-1].name;this.useIndexColumn&&(s.data.$$$_index_$$$=new l.DataCell({value:s.data[a].value,rendered:this.getRenderedFromHtml(s.data[a]),html:s.data[a].html,cell_style:["indent"],align:"left",rowspan:1})),s.sort=[0,0,t],this.data.push(s)})}addColumnSeries(){this.columns.forEach(e=>{var t=[],s=[],a=[];this.data.forEach(i=>{t.push(i.id),s.push(i.data[e.id].value),a.push(i.type)});var i=new l.ColumnSeries({column:e,is_numeric:e.modelField.is_numeric,series:{keys:t,values:s,types:a}});e.series=i,this.column_series.push(i)})}buildTotals(e){var t=e.totals_data,s=new l.Row("total");if(this.columns.forEach(e=>{if(s.id="Total",s.data[e.id]=new l.DataCell({value:"",cell_style:["total"]}),"measure"===e.modelField.type){var a=e.pivoted?t[e.modelField.name][e.pivot_key]:t[e.id];void 0===(a=new l.DataCell(a)).rendered&&void 0!==a.html&&(a.rendered=this.getRenderedFromHtml(a)),a.cell_style=["total"],s.data[e.id]=a,void 0!==s.data[e.id].links&&s.data[e.id].links.forEach(e=>{e.type="measure_default"})}}),this.useIndexColumn?s.data.$$$_index_$$$.value="TOTAL":this.firstVisibleDimension&&(s.data[this.firstVisibleDimension].value="TOTAL"),s.sort=[1,0,0],this.data.push(s),this.calculateOthers){var a=new l.Row("line_item");a.id="Others",this.columns.forEach(e=>{var s=null,r=[],n=e.pivoted?t[e.modelField.name][e.pivot_key]:t[e.id];if("measure"===e.modelField.type&&((s=["sum","count"].includes(e.modelField.calculation_type))?s=n.value-e.series.series.sum:(s=(n.value+e.series.series.avg)/2,r.push("estimate"),["count","count_distinct"].includes(e.modelField.calculation_type)&&(s=Math.round(s)))),s){var o=""===e.modelField.value_format?s.toString():i.a.format(e.modelField.value_format,s);a.data[e.id]=new l.DataCell({value:s,rendered:o,cell_style:r})}else a.data[e.id]=new l.DataCell}),this.useIndexColumn?a.data.$$$_index_$$$.value="Others":this.firstVisibleDimension&&(a.data[this.firstVisibleDimension].value="Others"),a.sort=[1,-1,-1],this.data.push(a)}this.sortData()}setRowSpans(){var e,t=[],s=this.rowspan_values,a={};e=this.data,(t=this.dimensions.filter(e=>!e.hide)).forEach(e=>{a[e.id]=1});for(var i=e.length-1;i>=0;i--){var l=e[i];if("line_item"===l.type){s[l.id]={};for(var r=0;r<t.length;r++){var n=t[r],o=l.data[n.name].value,h=i>0?e[i-1].data[n.name].value:null;if(!(i>0&&o===h)){for(var d=r;d<t.length;d++){var u=t[d];s[l.id][u.name]=a[u.name],l.data[u.name].rowspan=a[u.name],a[u.name]=1}break}s[l.id][n.name]=-1,l.data[n.name].rowspan=-1,a[n.name]+=1}}else t.forEach(e=>{a[e.name]=1})}}addSubTotals(){var e=this.addSubtotalDepth,t=[],s=[];this.data.forEach((a,i)=>{if("total"!==a.type){for(var l=[],r=0;r<e;r++){var n=this.dimensions[r].name;l.push(a.data[n].value)}l.join("|")!==s.join("|")&&(t.push(l),s=l),a.sort=[0,t.length-1,i]}}),t.forEach((e,t)=>{var s=new l.Row("subtotal");s.id="Subtotal|"+e.join("|"),this.columns.forEach(a=>{if(s.data[a.id]={cell_style:["total","subtotal"]},"$$$_index_$$$"===a.id||a.id===this.firstVisibleDimension){var l=e.join(" | ");s.data[a.id].value=l}if("measure"==a.modelField.type)if(Object.entries(this.subtotals_data).length>0)s.data[a.id]={...s.data[a.id],...this.subtotals_data[s.id].data[a.id]};else{var r=a.pivoted?[a.pivot_key,a.modelField.name].join("."):a.id,n=0,o=0,h="";this.data.forEach(e=>{if("line_item"==e.type&&e.sort[1]==t){var s=e.data[r].value;Number.isFinite(s)&&(n+=s,o++)}}),"average"===a.modelField.calculation_type&&o>0&&(n/=o),n&&(h=""===a.modelField.value_format?n.toString():i.a.format(a.modelField.value_format,n)),"string"===a.modelField.calculation_type&&(n="",h="");var d={value:n,rendered:h,cell_style:["subtotal","total"]};s.data[r]=d}}),s.sort=[0,t,9999],this.data.push(s)}),this.sortData(),this.hasSubtotals=!0}addColumnSubTotals(){var e="",t={},s=[],a=[],r=this.pivot_fields[0].name;this.pivot_values.forEach(e=>{var t=e.data[r];null!==t&&a.push(t)}),(a=[...new Set(a)]).forEach((a,i)=>{var l=[0,""],r=null;this.measures.forEach((n,o)=>{if(n.can_pivot){var h={modelField:n,pivot:a,measure_idx:o,pivot_idx:i,columns:[],id:["$$$_subtotal_$$$",a,n.name].join("."),after:""};this.columns.forEach((e,t)=>{e.pivoted&&e.levels[0]==a&&(e.modelField.name==n.name&&h.columns.push(e.id),e.levels[0]==a&&t>l[0]&&(l=[t,e.id]))}),a!=e&&(t[a]=l[1],r=null),h.after=r||t[a],e=a,r=h.id,s.push(h)}})}),s.forEach((e,t)=>{var s=this.measures[e.measure_idx],a=new l.Column(e.id,this,s);a.pivoted=!0,a.subtotal=!0,a.pivot_key=[e.pivot,"$$$_subtotal_$$$"].join("|"),this.headers.forEach(t=>{switch(t.type){case"pivot0":a.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{name:this.pivot_fields[0].name,label:e.pivot}}));break;case"pivot1":a.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{name:"subtotal",label:"Subtotal"}}));break;case"heading":a.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:s}));break;case"field":a.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:s}))}});var i=a.levels.map(e=>e.label);a.sort_by_measure_values=[1,e.measure_idx,...i],i[i.length-1]="string"==typeof i[i.length-1]?i[i.length-1]="ZZZZ":i[i.length-1]=9999,a.sort_by_pivot_values=[1,...i,1e4+t],this.columns.push(a)}),this.sortColumns(),this.data.forEach(e=>{s.forEach(t=>{var s=0;t.columns.forEach(t=>{s+=e.data[t].value}),e.data[t.id]={value:s,rendered:""===t.modelField.value_format?s.toString():i.a.format(t.modelField.value_format,s),align:"right",cell_style:["subtotal"]},["subtotal","total"].includes(e.type)&&e.data[t.id].cell_style.push("total")})})}calculateVariance(e,t,s,a,l){this.data.forEach(r=>{var n=r.data[a.id].value,o=r.data[l.id].value;if("absolute"===s)var h={value:n-o,rendered:""===e?(n-o).toString():i.a.format(e,n-o),cell_style:[]};else{var d=(n-o)/Math.abs(o);if(isFinite(d))h={value:d,rendered:i.a.format("#0.00%",d),cell_style:[]};else var h={value:null,rendered:"∞",cell_style:[]}}"total"!=r.type&&"subtotal"!=r.type||h.cell_style.push("total"),"subtotal"===r.type&&h.cell_style.push("subtotal"),h.value<0&&h.cell_style.push("red"),r.data[t]=h})}createVarianceColumn(e){if(this.config.colSubtotals||!e.variance.baseline.startsWith("$$$_subtotal_$$$")){var t=["$$$_variance_$$$",e.calc,e.variance.baseline,e.variance.comparison].join("|"),s=this.getColumnById(e.variance.baseline),a=this.getColumnById(e.variance.comparison),i=new l.Column(t,this,s.modelField);"absolute"===e.calc?(i.variance_type="absolute",i.idx=s.idx+1,i.pos=s.pos+1,i.sort_by_measure_values=s.sort_by_measure_values.concat(1),i.sort_by_pivot_values=s.sort_by_pivot_values.concat(1),i.hide=!this.config["var_num|"+s.modelField.name]):(i.variance_type="percentage",i.idx=s.idx+2,i.pos=s.pos+2,i.sort_by_measure_values=s.sort_by_measure_values.concat(2),i.sort_by_pivot_values=s.sort_by_pivot_values.concat(2),i.unit="%",i.hide=!this.config["var_pct|"+s.modelField.name]),s.sort_by_measure_values.length<i.sort_by_measure_values.length&&s.sort_by_measure_values.push(0),s.sort_by_pivot_values.length<i.sort_by_pivot_values.length&&s.sort_by_pivot_values.push(0),void 0!==this.config.columnOrder[i.id]&&(i.pos=this.config.columnOrder[i.id]),i.pivoted=s.pivoted,i.super=s.super,i.pivot_key="",i.levels=s.levels,this.groupVarianceColumns&&("pivots"===this.config.sortColumnsBy&&(i.sort_by_pivot_values[0]=1.5),this.headers.forEach(e=>{switch(e.type){case"pivot0":i.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{name:"variance",label:"Variance"}}));break;case"pivot1":i.levels.push(new l.HeaderCell({vis:this,type:"pivot",modelField:{name:s.id,label:s.levels[1]}}));break;case"heading":i.levels.push(new l.HeaderCell({vis:this,type:"heading",modelField:modelField}));break;case"field":i.levels.push(new l.HeaderCell({vis:this,type:"field",modelField:modelField}))}})),this.columns.push(i),e.variance.reverse?this.calculateVariance(s.modelField.value_format,t,e.calc,a,s):this.calculateVariance(s.modelField.value_format,t,e.calc,s,a)}else console.log("Cannot calculate variance of column subtotals if subtotals disabled.")}addVarianceColumns(){var e=[],t=["absolute","percent"];Object.keys(this.variances).forEach(s=>{var a=this.variances[s];if("no_variance"!==a.comparison)if("vs_measure"===a.type)this.hasPivots?this.pivot_values.forEach(s=>{s.is_total||t.forEach(t=>{e.push({calc:t,variance:{baseline:[s.key,a.baseline].join("."),comparison:[s.key,a.comparison].join("."),reverse:a.reverse,type:a.type}})})}):t.forEach(t=>{e.push({variance:a,calc:t})});else if("by_pivot"===a.type)if(1===this.pivot_fields.length||this.pivot_fields[1].name===a.comparison)this.pivot_values.slice(1).forEach((s,i)=>{t.forEach(t=>{s.is_total||e.push({calc:t,variance:{baseline:[s.key,a.baseline].join("."),comparison:[this.pivot_values[i].key,a.baseline].join("."),reverse:a.reverse,type:a.type}})})});else{var i=[];this.pivot_values.forEach(e=>{if(!e.is_total){var t=e.data[this.pivot_fields[0].name];i.includes(t)||i.push(t)}}),i.slice(1).forEach((s,l)=>{t.forEach(t=>{e.push({calc:t,variance:{baseline:["$$$_subtotal_$$$",s,a.baseline].join("."),comparison:["$$$_subtotal_$$$",i[l],a.baseline].join("."),reverse:a.reverse,type:a.type}})})})}}),e.forEach(e=>{this.createVarianceColumn(e)})}sortColumns(){this.columns.sort((e,t)=>{for(var s=this.sortColsBy,a=e[s]().length,i=0;i<a;i++){if(e[s]()[i]>t[s]()[i])return 1;if(e[s]()[i]<t[s]()[i])return-1}return-1})}setColSpans(){var e=[],t=[],s=this.colspan_values,a={};this.columns.filter(e=>!e.hide).forEach(t=>{var s={id:t.id,data:t.getHeaderData()};e.push(s)}),console.log("leaves",e),(t=this.headers).forEach(e=>{a[e.type]=1}),console.log("tiers",t);for(var i=e.length-1;i>=0;i--){var l=e[i];s[l.id]={};for(var r=0;r<t.length;r++){var n=t[r],o=l.data[n.type].label,h=i>0?e[i-1].data[n.type].label:null;if(!(i>0&&o===h)){for(var d=r;d<t.length;d++){var u=t[d];s[l.id][u.type]=a[u.type],a[u.type]=1}break}s[l.id][n.type]=-1,a[n.type]+=1}}this.columns.forEach(e=>{void 0!==s[e.id]&&(e.colspans=s[e.id])})}applyFormatting(){this.columns.forEach(e=>{var t=this.config["style|"+e.modelField.name];if(void 0!==t)switch(t){case"black_red":this.data.forEach(t=>{t.data[e.id].value<0&&t.data[e.id].cell_style.push("red")})}})}transposeColumns(){this.transposed_headers=this.columns.filter(e=>"measure"!==e.modelField.type).filter(e=>!e.hide).map(e=>new l.HeaderCell({vis:this,queryResponseField:e.modelField}));var e=this.transposed_headers.map(e=>{({})[e.name]=1}),t={align:"left",type:"transposed_table_index",is_table_calculation:!1},s={align:"right",type:"transposed_table_measure",is_table_calculation:!1};this.useHeadings&&!this.hasPivots&&((i=new l.Column("header",this,t)).levels=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})),i.levels[0]=new l.HeaderCell({vis:this,queryResponseField:{name:"header",label:"Header"}}),i.colspans=e,i.type="dimension",this.transposed_columns.push(i));"pivots"===this.sortColsBy?(this.pivot_fields.forEach(s=>{var a=new l.Column(s.name,this,t);a.levels=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})),a.levels[0]=new l.HeaderCell({vis:this,queryResponseField:{name:s.name,label:s.label}}),a.colspans=e,this.transposed_columns.push(a)}),(i=new l.Column("measure",this,t)).levels=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})),i.levels[0]=new l.HeaderCell({vis:this,queryResponseField:{name:"measure",label:"Measure"}}),i.colspans=e,this.transposed_columns.push(i)):((i=new l.Column("measure",this,t)).levels=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})),i.levels[0]=new l.HeaderCell({vis:this,queryResponseField:{name:"measure",label:"Measure"}}),i.colspans=e,this.transposed_columns.push(i),this.pivot_fields.forEach(s=>{var a=new l.Column(s.name,this,t);a.levels=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})),a.levels[0]=new l.HeaderCell({vis:this,queryResponseField:{name:s.name,label:s.label}}),a.colspans=e,this.transposed_columns.push(a)}));for(var a=0;a<this.data.length;a++){var i,r=this.data[a];if("line_item"===r.type){var n={},o=[];this.transposed_headers.forEach(e=>{n=this.rowspan_values[r.id],o.push(r.data[e.name].value)})}else if("subtotal"===r.type){n=e;(o=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})))[0]=new l.HeaderCell({vis:this,queryResponseField:{name:"subtotal",label:"Subtotal"}})}else if("total"===r.type){n=e;(o=Object(l.newArray)(this.transposed_headers.length,new l.HeaderCell({vis:this,queryResponseField:{}})))[0]=new l.HeaderCell({vis:this,queryResponseField:{name:"total",label:"Total"}})}(i=new l.Column(r.id,this,s)).transposed=!0,i.colspan_values=n,i.levels=o,this.transposed_columns.push(i)}}transposeRows(){this.columns.filter(e=>"measure"===e.modelField.type).forEach(e=>{var t={};this.data.forEach(s=>{void 0!==s.data[e.id]?(t[s.id]=s.data[e.id],t[s.id].align="right",void 0!==t[s.id].cell_style?t[s.id].cell_style.push("transposed"):t[s.id].cell_style=["transposed"]):console.log("row data does not exist for",e.id)});var s=e.modelField.heading,a=this.config["heading|"+e.modelField.name];void 0!==a&&(s=a||s),t.header={value:s,cell_style:[]},e.subtotal&&t.header.cell_style.push("subtotal");var i="pivots"===this.sortColsBy?this.pivot_fields.length:0;this.useHeadings&&!this.hasPivots&&i++,t.measure={value:e.getLabel(i),cell_style:[]},e.subtotal&&t.measure.cell_style.push("subtotal"),e.modelField.style.includes("subtotal")&&t.measure.cell_style.push("subtotal"),this.pivot_fields.forEach((s,a)=>{t[s.name]={value:e.levels[a],cell_style:[]},e.subtotal&&t[s.name].cell_style.push("subtotal")});var r=new l.Row("line_item");r.id=e.id,r.modelField=e.modelField,r.hide=e.hide,r.data=t,this.transposed_data.push(r)})}validateConfig(){["traditional","looker","contemporary","custom"].includes(this.config.theme)||(this.config.theme="traditional"),["fixed","auto"].includes(this.config.layout)||(this.config.layout="fixed"),void 0===this.config.transposeTable&&(this.config.transposeTable=!1),Object.entries(this.config).forEach(e=>{if("false"===e[1]?e[1]=!1:"true"===e[1]&&(e[1]=!0),2===e[0].split("|").length){var[t,s]=e[0].split("|");if(["label","heading","hide","style","switch","var_num","var_pct","comparison"].includes(t)){var a=!1;this.dimensions.forEach(e=>{e.name===s&&(a=!0)}),this.measures.forEach(e=>{e.name===s&&(a=!0)}),a||delete this.config[e[0]]}}})}getColumnById(e){var t={};return this.columns.forEach(s=>{e===s.id&&(t=s)}),t}getMeasureByName(e){var t="";return this.measures.forEach(s=>{e===s.name&&(t=s)}),t}sortData(){this.data.sort((e,t)=>{for(var s=e.sort.length,a=0;a<s;a++){if(e.sort[a]>t.sort[a])return 1;if(e.sort[a]<t.sort[a])return-1}return-1}),this.spanRows&&this.setRowSpans()}getRenderedFromHtml(e){var t=new DOMParser;if(void 0===e.html||["undefined",""].includes(e.html))s=e.value;else try{var s=t.parseFromString(e.html,"text/html").documentElement.textContent}catch(t){var s=e.html}return s}getHeaderTiers(){return this.transposeTable?this.dimensions.filter(e=>!e.hide):this.headers}getTableColumnGroups(){var e=[],t=[],s=[];this.transposeTable?this.transposed_columns.forEach(a=>{"transposed_table_index"===a.modelField.type?e.push({id:a.id}):"transposed_table_measure"===a.modelField.type&&"Total"!==a.id?t.push({id:a.id}):"transposed_table_measure"===a.modelField.type&&"Total"===a.id&&s.push({id:a.id})}):this.columns.forEach(a=>{"dimension"!==a.modelField.type||this.useIndexColumn||"$$$_index_$$$"===a.id||a.hide?"dimension"===a.modelField.type&&this.useIndexColumn&&"$$$_index_$$$"===a.id?e.push({id:a.id}):"measure"!==a.modelField.type||a.super||a.hide?"measure"===a.modelField.type&&a.super&&!a.hide&&s.push({id:a.id}):t.push({id:a.id}):e.push({id:a.id})})}getTableHeaderColumns(e){return this.transposeTable?this.transposed_columns.filter(t=>t.colspans[e]>0):this.columns.filter(e=>!e.hide).filter(t=>this.colspan_values[t.id][this.headers[e].type]>0)}getDataRows(){return this.transposeTable?this.transposed_data.filter(e=>!e.hide):this.data}getTableRowColumns(e){if(this.transposeTable)(t=this.transposed_columns).forEach((t,s)=>{"transposed_table_index"===t.modelField.type&&(t.rowspan=this.colspan_values[e.id][this.headers[s].name])}),t=t.filter(e=>e.rowspan>0);else var t=this.columns.filter(e=>!e.hide).filter(t=>e.data[t.id].rowspan>0);return t}moveColumns(e,t,s){var a=this.config;if(e!=t){var i=t-e,l=a.columnOrder;this.columns.forEach(s=>{"measure"!=s.modelField.type||s.super||(s.pos>=e&&s.pos<e+10?s.pos+=i:s.pos>=t&&s.pos<e?s.pos+=10:s.pos>=e+10&&s.pos<t+10&&(s.pos-=10),l[s.id]=s.pos)}),s(l)}}getSimpleJson(){var e=[];return this.data.forEach(t=>{if("line_item"===t.type){var s={};this.columns.forEach(e=>{s[e.id]=t.data[e.id].value}),e.push(s)}}),e}}}]);
//# sourceMappingURL=vis_table_plugin.js.map
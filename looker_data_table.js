!function(e){var t={};function s(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t){class s extends class{constructor({vis:e,name:t,view:s,label:a,is_numeric:i,value_format:r="",heading:n="",short_name:l="",unit:o=""}){this.vis=e,this.name=t,this.view=s,this.label=a,this.is_numeric=i,this.value_format=r,this.heading=n,this.short_name=l,this.unit=o}}{constructor({vis:e,name:t,view:s,label:a,is_numeric:i,value_format:r="",heading:n="",short_name:l="",unit:o=""}){super({vis:e,name:t,view:s,label:a,is_numeric:i,value_format:r,heading:n,short_name:l,unit:o}),this.type="dimension",this.align="left",this.hide=!1,void 0!==this.vis.config["hide|"+this.name]&&this.vis.config["hide|"+this.name]&&(this.hide=!0)}}class a{constructor({keys:e,values:t,types:s=[]}){if(e.length===t.length){this.keys=e,this.values=t,this.types=[];for(var a=[],i=[],r=0;r<e.length;r++)this.types[r]=void 0!==s[r]?s[r]:"line_item","line_item"===this.types[r]?(a.push(this.values[r]),i.push(this.values[r])):"subtotal"===this.types[r]&&i.push(this.values[r]);this.min_for_display=Math.min(i),this.max_for_display=Math.max(i),this.min=Math.min(a),this.max=Math.max(a),this.sum=a.reduce((e,t)=>e+t,0),this.count=a.length,this.avg=a.length>0?this.sum/a.length:null}else console.log("Could not construct series, arrays were of different length.")}}t.newArray=function(e,t){for(var s=[],a=0;a<e;a++)s.push(t);return s},t.ModelDimension=s,t.ModelMeasure=class extends s{constructor({vis:e,name:t,view:s,label:a,is_numeric:i,is_table_calculation:r,calculation_type:n,can_pivot:l,is_turtle:o=!1,heading:h="",short_name:u="",unit:c="",value_format:d=""}){super({vis:e,name:t,view:s,label:a,is_numeric:i,value_format:d,heading:h,short_name:u,unit:c}),this.type="measure",this.is_table_calculation=r,this.calculation_type=n,this.can_pivot=l,this.is_turtle=o,this.align="right",this.hide=!1,this.style=[],void 0!==this.vis.config["style|"+this.name]&&("hide"===this.vis.config["style|"+this.name]?this.hide=!0:this.style.push(this.vis.config["style|"+this.name]))}},t.CellSeries=class{constructor({column:e,row:t,sort_value:s,series:i}){this.column=e,this.row=t,this.sort_value=s,this.series=new a(i)}to_string(){for(var e="",t=0;t<this.series.keys.length;t++){e+=this.series.keys[t]+":",e+=(""===this.column.modelField.value_format?this.series.values[t].toString():SSF.format(this.column.modelField.value_format,this.series.values[t]))+" "}return e}},t.ColumnSeries=class{constructor({column:e,is_numeric:t,series:s}){this.column=e,this.is_numeric=t,this.series=new a(s)}},t.PivotField=class{constructor({name:e,label:t,view:s}){this.name=e,this.label=t,this.view=s}},t.Row=class{constructor(e="line_item"){this.id="",this.modelField=null,this.type=e,this.sort=[],this.data={}}},t.Column=class{constructor(e,t,s){this.id=e,this.vis=t,this.modelField=s,this.transposed=!1,this.idx=0,this.pos=0,this.levels=[],this.pivot_key="",this.colspans=[],this.unit=s.unit||"",this.hide=s.hide||!1,this.variance_type="",this.pivoted=!1,this.subtotal=!1,this.super=!1,this.series=null,this.sort_by_measure_values=[],this.sort_by_pivot_values=[]}getLabel(e){if(this.transposed)return this.labels[e];if(void 0!==this.vis.useShortName)switch(this.variance_type){case"absolute":var t="Var #";break;case"percentage":t="Var %";break;default:t=this.vis.useShortName&&this.modelField.short_name||this.modelField.label}else t=this.modelField.label;var s="label|"+this.modelField.name;if(void 0!==this.vis.config[s]&&this.vis.config[s]!==this.modelField.label&&(t=this.vis.config[s]?this.vis.config[s]:t),void 0!==this.vis.useViewName&&this.vis.useViewName&&(t=[this.modelField.view,t].join(" ")),void 0!==this.vis.has_pivots)if(this.vis.has_pivots)"getSortByPivots"===this.vis.sortColsBy?e<this.levels.length&&(t=this.levels[e]):e>=1&&(t=this.levels[e-1]);else if(this.vis.useHeadings&&0===e){s="heading|"+this.modelField.name;t=void 0!==this.vis.config[s]&&this.vis.config[s]?this.vis.config[s]:this.modelField.heading}return t}updateSortByMeasures(e){1==this.sort_by_measure_values[0]&&(this.pivoted||this.subtotal||(this.sort_by_measure_values=[1,e]))}getSortByMeasures(){return this.sort_by_measure_values}getSortByPivots(){return this.sort_by_pivot_values}}},function(e,t,s){var a={};!function(e){function t(e){for(var t="",s=e.length-1;s>=0;)t+=e.charAt(s--);return t}function s(e,t){for(var s="";s.length<t;)s+=e;return s}function a(e,t){var a=""+e;return a.length>=t?a:s("0",t-a.length)+a}function i(e,t){var a=""+e;return a.length>=t?a:s(" ",t-a.length)+a}function r(e,t){var a=""+e;return a.length>=t?a:a+s(" ",t-a.length)}e.version="0.11.0";var n=Math.pow(2,32);function l(e,t){return e>n||e<-n?function(e,t){var a=""+Math.round(e);return a.length>=t?a:s("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:s("0",t-a.length)+a}(Math.round(e),t)}function o(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var h=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],u=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function c(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var d={};function v(e,t,s){for(var a=e<0?-1:1,i=e*a,r=0,n=1,l=0,o=1,h=0,u=0,c=Math.floor(i);h<t&&(l=(c=Math.floor(i))*n+r,u=c*h+o,!(i-c<5e-8));)i=1/(i-c),r=n,n=l,o=h,h=u;if(u>t&&(h>t?(u=o,l=r):(u=h,l=n)),!s)return[0,a*l,u];var d=Math.floor(a*l/u);return[d,a*l-d*u,u]}function f(e,t,s){if(e>2958465||e<0)return null;var a=0|e,i=Math.floor(86400*(e-a)),r=0,n=[],l={D:a,T:i,u:86400*(e-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,86400==++i&&(l.T=i=0,++a,++l.D)),60===a)n=s?[1317,10,29]:[1900,2,29],r=3;else if(0===a)n=s?[1317,8,29]:[1900,1,0],r=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),n=[o.getFullYear(),o.getMonth()+1,o.getDate()],r=o.getDay(),a<60&&(r=(r+6)%7),s&&(r=0)}return l.y=n[0],l.m=n[1],l.d=n[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=r,l}c(d),e.parse_date_code=f;var p=new Date(1899,11,31,0,0,0),m=p.getTime(),_=new Date(1900,2,1,0,0,0);function g(e,t){var s=e.getTime();return t?s-=1262304e5:e>=_&&(s+=864e5),(s-(m+6e4*(e.getTimezoneOffset()-p.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var b=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,s=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,i=/(E[+-])(\d)$/;function r(s){return s.indexOf(".")>-1?s.replace(t,"").replace(e,".$1"):s}return function(t){var n,l=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return n=l>=-4&&l<=-1?t.toPrecision(10+l):Math.abs(l)<=9?function(e){var t=e<0?12:11,s=r(e.toFixed(12));return s.length<=t||(s=e.toPrecision(10)).length<=t?s:e.toExponential(5)}(t):10===l?t.toFixed(10).substr(0,12):function(t){var s=t.toFixed(11).replace(e,".$1");return s.length>(t<0?12:11)&&(s=t.toPrecision(6)),s}(t),r(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(s,".$1").replace(a,"E").replace("e","E").replace(i,"$10$2");return e}(n))}}();function y(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):b(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return T(14,g(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $(e,t,s,i){var r,n="",l=0,o=0,c=s.y,d=0;switch(e){case 98:c=s.y+543;case 121:switch(t.length){case 1:case 2:r=c%100,d=2;break;default:r=c%1e4,d=4}break;case 109:switch(t.length){case 1:case 2:r=s.m,d=t.length;break;case 3:return u[s.m-1][1];case 5:return u[s.m-1][0];default:return u[s.m-1][2]}break;case 100:switch(t.length){case 1:case 2:r=s.d,d=t.length;break;case 3:return h[s.q][0];default:return h[s.q][1]}break;case 104:switch(t.length){case 1:case 2:r=1+(s.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:r=s.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:r=s.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==s.u||"s"!=t&&"ss"!=t?(o=i>=2?3===i?1e3:100:1===i?10:1,(l=Math.round(o*(s.S+s.u)))>=60*o&&(l=0),"s"===t?0===l?"0":""+l/o:(n=a(l,2+i),"ss"===t?n.substr(0,2):"."+n.substr(2,t.length-1))):a(s.S,t.length);case 90:switch(t){case"[h]":case"[hh]":r=24*s.D+s.H;break;case"[m]":case"[mm]":r=60*(24*s.D+s.H)+s.M;break;case"[s]":case"[ss]":r=60*(60*(24*s.D+s.H)+s.M)+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+t}d=3===t.length?1:2;break;case 101:r=c,d=1}return d>0?a(r,d):""}function w(e){if(e.length<=3)return e;for(var t=e.length%3,s=e.substr(0,t);t!=e.length;t+=3)s+=(s.length>0?",":"")+e.substr(t,3);return s}e._general_num=b,e._general=y;var k=function(){var e=/%/g;var n=/# (\?+)( ?)\/( ?)(\d+)/;var o=/^#*0*\.([0#]+)/,h=/\).*[0#]/,u=/\(###\) ###\\?-####/;function c(e){for(var t,s="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(t)}return s}function d(e,t){var s=Math.pow(10,t);return""+Math.round(e*s)/s}function f(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function p(m,_,g){if(40===m.charCodeAt(0)&&!_.match(h)){var b=_.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return g>=0?p("n",b,g):"("+p("n",b,-g)+")"}if(44===_.charCodeAt(_.length-1))return function(e,t,s){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return k(e,t.substr(0,a),s/Math.pow(10,3*(t.length-a)))}(m,_,g);if(-1!==_.indexOf("%"))return function(t,a,i){var r=a.replace(e,""),n=a.length-r.length;return k(t,r,i*Math.pow(10,2*n))+s("%",n)}(m,_,g);if(-1!==_.indexOf("E"))return function e(t,s){var a,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+e(t,-s);var r=t.indexOf(".");-1===r&&(r=t.indexOf("E"));var n=Math.floor(Math.log(s)*Math.LOG10E)%r;if(n<0&&(n+=r),-1===(a=(s/Math.pow(10,n)).toPrecision(i+1+(r+n)%r)).indexOf("e")){var l=Math.floor(Math.log(s)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+n):a+="E+"+(l-n);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,r)+"."+a.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,s,a){return t+s+a.substr(0,(r+n)%r)+"."+a.substr(n)+"E"}))}else a=s.toExponential(i);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(_,g);if(36===_.charCodeAt(0))return"$"+p(m,_.substr(" "==_.charAt(1)?2:1),g);var y,$,M,x,C=Math.abs(g),S=g<0?"-":"";if(_.match(/^00+$/))return S+l(C,_.length);if(_.match(/^[#?]+$/))return"0"===(y=l(g,0))&&(y=""),y.length>_.length?y:c(_.substr(0,_.length-y.length))+y;if($=_.match(n))return function(e,t,r){var n=parseInt(e[4],10),l=Math.round(t*n),o=Math.floor(l/n),h=l-o*n,u=n;return r+(0===o?"":""+o)+" "+(0===h?s(" ",e[1].length+1+e[4].length):i(h,e[1].length)+e[2]+"/"+e[3]+a(u,e[4].length))}($,C,S);if(_.match(/^#+0+$/))return S+l(C,_.length-_.indexOf("0"));if($=_.match(o))return y=d(g,$[1].length).replace(/^([^\.]+)$/,"$1."+c($[1])).replace(/\.$/,"."+c($[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+s("0",c($[1]).length-t.length)})),-1!==_.indexOf("0.")?y:y.replace(/^0\./,".");if(_=_.replace(/^#+([0.])/,"$1"),$=_.match(/^(0*)\.(#*)$/))return S+d(C,$[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,$[1].length?"0.":".");if($=_.match(/^#{1,3},##0(\.?)$/))return S+w(l(C,0));if($=_.match(/^#,##0\.([#0]*0)$/))return g<0?"-"+p(m,_,-g):w(""+(Math.floor(g)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(g,$[1].length)))+"."+a(f(g,$[1].length),$[1].length);if($=_.match(/^#,#*,#0/))return p(m,_.replace(/^#,#*,/,""),g);if($=_.match(/^([0#]+)(\\?-([0#]+))+$/))return y=t(p(m,_.replace(/[\\-]/g,""),g)),M=0,t(t(_.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return M<y.length?y.charAt(M++):"0"===e?"0":""})));if(_.match(u))return"("+(y=p(m,"##########",g)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var A="";if($=_.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min($[4].length,7),x=v(C,Math.pow(10,M)-1,!1),y=""+S," "==(A=k("n",$[1],x[1])).charAt(A.length-1)&&(A=A.substr(0,A.length-1)+"0"),y+=A+$[2]+"/"+$[3],(A=r(x[2],M)).length<$[4].length&&(A=c($[4].substr($[4].length-A.length))+A),y+=A;if($=_.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min(Math.max($[1].length,$[4].length),7),S+((x=v(C,Math.pow(10,M)-1,!0))[0]||(x[1]?"":"0"))+" "+(x[1]?i(x[1],M)+$[2]+"/"+$[3]+r(x[2],M):s(" ",2*M+1+$[2].length+$[3].length));if($=_.match(/^[#0?]+$/))return y=l(g,0),_.length<=y.length?y:c(_.substr(0,_.length-y.length))+y;if($=_.match(/^([#0?]+)\.([#0]+)$/)){y=""+g.toFixed(Math.min($[2].length,10)).replace(/([^0])0+$/,"$1"),M=y.indexOf(".");var O=_.indexOf(".")-M,E=_.length-y.length-O;return c(_.substr(0,O)+y+_.substr(_.length-E))}if($=_.match(/^00,000\.([#0]*0)$/))return M=f(g,$[1].length),g<0?"-"+p(m,_,-g):w(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(g)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(M,$[1].length);switch(_){case"###,##0.00":return p(m,"#,##0.00",g);case"###,###":case"##,###":case"#,###":var T=w(l(C,0));return"0"!==T?S+T:"";case"###,###.00":return p(m,"###,##0.00",g).replace(/^0\./,".");case"#,###.00":return p(m,"#,##0.00",g).replace(/^0\./,".")}throw new Error("unsupported format |"+_+"|")}function m(l,d,f){if(40===l.charCodeAt(0)&&!d.match(h)){var p=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?m("n",p,f):"("+m("n",p,-f)+")"}if(44===d.charCodeAt(d.length-1))return function(e,t,s){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return k(e,t.substr(0,a),s/Math.pow(10,3*(t.length-a)))}(l,d,f);if(-1!==d.indexOf("%"))return function(t,a,i){var r=a.replace(e,""),n=a.length-r.length;return k(t,r,i*Math.pow(10,2*n))+s("%",n)}(l,d,f);if(-1!==d.indexOf("E"))return function e(t,s){var a,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+e(t,-s);var r=t.indexOf(".");-1===r&&(r=t.indexOf("E"));var n=Math.floor(Math.log(s)*Math.LOG10E)%r;if(n<0&&(n+=r),!(a=(s/Math.pow(10,n)).toPrecision(i+1+(r+n)%r)).match(/[Ee]/)){var l=Math.floor(Math.log(s)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+n):a+="E+"+(l-n),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,s,a){return t+s+a.substr(0,(r+n)%r)+"."+a.substr(n)+"E"}))}else a=s.toExponential(i);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(d,f);if(36===d.charCodeAt(0))return"$"+m(l,d.substr(" "==d.charAt(1)?2:1),f);var _,g,b,y,$=Math.abs(f),M=f<0?"-":"";if(d.match(/^00+$/))return M+a($,d.length);if(d.match(/^[#?]+$/))return _=""+f,0===f&&(_=""),_.length>d.length?_:c(d.substr(0,d.length-_.length))+_;if(g=d.match(n))return function(e,t,a){return a+(0===t?"":""+t)+s(" ",e[1].length+2+e[4].length)}(g,$,M);if(d.match(/^#+0+$/))return M+a($,d.length-d.indexOf("0"));if(g=d.match(o))return _=(_=(""+f).replace(/^([^\.]+)$/,"$1."+c(g[1])).replace(/\.$/,"."+c(g[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+s("0",c(g[1]).length-t.length)})),-1!==d.indexOf("0.")?_:_.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),g=d.match(/^(0*)\.(#*)$/))return M+(""+$).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,g[1].length?"0.":".");if(g=d.match(/^#{1,3},##0(\.?)$/))return M+w(""+$);if(g=d.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+m(l,d,-f):w(""+f)+"."+s("0",g[1].length);if(g=d.match(/^#,#*,#0/))return m(l,d.replace(/^#,#*,/,""),f);if(g=d.match(/^([0#]+)(\\?-([0#]+))+$/))return _=t(m(l,d.replace(/[\\-]/g,""),f)),b=0,t(t(d.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return b<_.length?_.charAt(b++):"0"===e?"0":""})));if(d.match(u))return"("+(_=m(l,"##########",f)).substr(0,3)+") "+_.substr(3,3)+"-"+_.substr(6);var x="";if(g=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(g[4].length,7),y=v($,Math.pow(10,b)-1,!1),_=""+M," "==(x=k("n",g[1],y[1])).charAt(x.length-1)&&(x=x.substr(0,x.length-1)+"0"),_+=x+g[2]+"/"+g[3],(x=r(y[2],b)).length<g[4].length&&(x=c(g[4].substr(g[4].length-x.length))+x),_+=x;if(g=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(g[1].length,g[4].length),7),M+((y=v($,Math.pow(10,b)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?i(y[1],b)+g[2]+"/"+g[3]+r(y[2],b):s(" ",2*b+1+g[2].length+g[3].length));if(g=d.match(/^[#0?]+$/))return _=""+f,d.length<=_.length?_:c(d.substr(0,d.length-_.length))+_;if(g=d.match(/^([#0]+)\.([#0]+)$/)){_=""+f.toFixed(Math.min(g[2].length,10)).replace(/([^0])0+$/,"$1"),b=_.indexOf(".");var C=d.indexOf(".")-b,S=d.length-_.length-C;return c(d.substr(0,C)+_+d.substr(d.length-S))}if(g=d.match(/^00,000\.([#0]*0)$/))return f<0?"-"+m(l,d,-f):w(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e}))+"."+a(0,g[1].length);switch(d){case"###,###":case"##,###":case"#,###":var A=w(""+$);return"0"!==A?M+A:"";default:if(d.match(/\.[0#?]*$/))return m(l,d.slice(0,d.lastIndexOf(".")),f)+c(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}return function(e,t,s){return(0|s)===s?m(e,t,s):p(e,t,s)}}();function M(e){for(var t=[],s=!1,a=0,i=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(i,a-i),i=a+1}if(t[t.length]=e.substr(i),!0===s)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=M;var x=/\[[HhMmSs]*\]/;function C(e){for(var t=0,s="",a="";t<e.length;)switch(s=e.charAt(t)){case"G":o(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=s;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(x))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++t))>-1||"\\"==s&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===s;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function S(e,t,s,a){for(var i,r,n,l=[],h="",u=0,c="",d="t",v="H";u<e.length;)switch(c=e.charAt(u)){case"G":if(!o(e,u))throw new Error("unrecognized character "+c+" in "+e);l[l.length]={t:"G",v:"General"},u+=7;break;case'"':for(h="";34!==(n=e.charCodeAt(++u))&&u<e.length;)h+=String.fromCharCode(n);l[l.length]={t:"t",v:h},++u;break;case"\\":var p=e.charAt(++u),m="("===p||")"===p?p:"t";l[l.length]={t:m,v:p},++u;break;case"_":l[l.length]={t:"t",v:" "},u+=2;break;case"@":l[l.length]={t:"T",v:t},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==i&&null==(i=f(t,s,"2"===e.charAt(u+1))))return"";l[l.length]={t:"X",v:e.substr(u,2)},d=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=f(t,s)))return"";for(h=c;++u<e.length&&e.charAt(u).toLowerCase()===c;)h+=c;"m"===c&&"h"===d.toLowerCase()&&(c="M"),"h"===c&&(c=v),l[l.length]={t:c,v:h},d=c;break;case"A":case"a":var _={t:c,v:c};if(null==i&&(i=f(t,s)),"A/P"===e.substr(u,3).toUpperCase()?(null!=i&&(_.v=i.H>=12?"P":"A"),_.t="T",v="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=i&&(_.v=i.H>=12?"PM":"AM"),_.t="T",u+=5,v="h"):(_.t="t",++u),null==i&&"T"===_.t)return"";l[l.length]=_,d=c;break;case"[":for(h=c;"]"!==e.charAt(u++)&&u<e.length;)h+=e.charAt(u);if("]"!==h.slice(-1))throw'unterminated "[" block: |'+h+"|";if(h.match(x)){if(null==i&&null==(i=f(t,s)))return"";l[l.length]={t:"Z",v:h.toLowerCase()},d=h.charAt(1)}else h.indexOf("$")>-1&&(h=(h.match(/\$([^-\[\]]*)/)||[])[1]||"$",C(e)||(l[l.length]={t:"t",v:h}));break;case".":if(null!=i){for(h=c;++u<e.length&&"0"===(c=e.charAt(u));)h+=c;l[l.length]={t:"s",v:h};break}case"0":case"#":for(h=c;++u<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(u))>-1;)h+=c;l[l.length]={t:"n",v:h};break;case"?":for(h=c;e.charAt(++u)===c;)h+=c;l[l.length]={t:c,v:h},d=c;break;case"*":++u," "!=e.charAt(u)&&"*"!=e.charAt(u)||++u;break;case"(":case")":l[l.length]={t:1===a?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(h=c;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)h+=e.charAt(u);l[l.length]={t:"D",v:h};break;case" ":l[l.length]={t:c,v:c},++u;break;case"$":l[l.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);l[l.length]={t:"t",v:c},++u}var g,b=0,w=0;for(u=l.length-1,d="t";u>=0;--u)switch(l[u].t){case"h":case"H":l[u].t=v,d="h",b<1&&(b=1);break;case"s":(g=l[u].v.match(/\.0+$/))&&(w=Math.max(w,g[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=l[u].t;break;case"m":"s"===d&&(l[u].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&l[u].v.match(/[Hh]/)&&(b=1),b<2&&l[u].v.match(/[Mm]/)&&(b=2),b<3&&l[u].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var M,S="";for(u=0;u<l.length;++u)switch(l[u].t){case"t":case"T":case" ":case"D":break;case"X":l[u].v="",l[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[u].v=$(l[u].t.charCodeAt(0),l[u].v,i,w),l[u].t="t";break;case"n":case"?":for(M=u+1;null!=l[M]&&("?"===(c=l[M].t)||"D"===c||(" "===c||"t"===c)&&null!=l[M+1]&&("?"===l[M+1].t||"t"===l[M+1].t&&"/"===l[M+1].v)||"("===l[u].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===l[M].v||" "===l[M].v&&null!=l[M+1]&&"?"==l[M+1].t));)l[u].v+=l[M].v,l[M]={v:"",t:";"},++M;S+=l[u].v,u=M-1;break;case"G":l[u].t="t",l[u].v=y(t,s)}var A,O,E="";if(S.length>0){40==S.charCodeAt(0)?(A=t<0&&45===S.charCodeAt(0)?-t:t,O=k("n",S,A)):(O=k("n",S,A=t<0&&a>1?-t:t),A<0&&l[0]&&"t"==l[0].t&&(O=O.substr(1),l[0].v="-"+l[0].v)),M=O.length-1;var T=l.length;for(u=0;u<l.length;++u)if(null!=l[u]&&"t"!=l[u].t&&l[u].v.indexOf(".")>-1){T=u;break}var D=l.length;if(T===l.length&&-1===O.indexOf("E")){for(u=l.length-1;u>=0;--u)null!=l[u]&&-1!=="n?".indexOf(l[u].t)&&(M>=l[u].v.length-1?(M-=l[u].v.length,l[u].v=O.substr(M+1,l[u].v.length)):M<0?l[u].v="":(l[u].v=O.substr(0,M+1),M=-1),l[u].t="t",D=u);M>=0&&D<l.length&&(l[D].v=O.substr(0,M+1)+l[D].v)}else if(T!==l.length&&-1===O.indexOf("E")){for(M=O.indexOf(".")-1,u=T;u>=0;--u)if(null!=l[u]&&-1!=="n?".indexOf(l[u].t)){for(r=l[u].v.indexOf(".")>-1&&u===T?l[u].v.indexOf(".")-1:l[u].v.length-1,E=l[u].v.substr(r+1);r>=0;--r)M>=0&&("0"===l[u].v.charAt(r)||"#"===l[u].v.charAt(r))&&(E=O.charAt(M--)+E);l[u].v=E,l[u].t="t",D=u}for(M>=0&&D<l.length&&(l[D].v=O.substr(0,M+1)+l[D].v),M=O.indexOf(".")+1,u=T;u<l.length;++u)if(null!=l[u]&&(-1!=="n?(".indexOf(l[u].t)||u===T)){for(r=l[u].v.indexOf(".")>-1&&u===T?l[u].v.indexOf(".")+1:0,E=l[u].v.substr(0,r);r<l[u].v.length;++r)M<O.length&&(E+=O.charAt(M++));l[u].v=E,l[u].t="t",D=u}}}for(u=0;u<l.length;++u)null!=l[u]&&"n?".indexOf(l[u].t)>-1&&(A=a>1&&t<0&&u>0&&"-"===l[u-1].v?-t:t,l[u].v=k(l[u].t,l[u].v,A),l[u].t="t");var j="";for(u=0;u!==l.length;++u)null!=l[u]&&(j+=l[u].v);return j}e.is_date=C,e._eval=S;var A=/\[[=<>]/,O=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function E(e,t){if(null==t)return!1;var s=parseFloat(t[2]);switch(t[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0}return!1}function T(e,t,s){null==s&&(s={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&s.dateNF?s.dateNF:e;break;case"number":a=14==e&&s.dateNF?s.dateNF:(null!=s.table?s.table:d)[e]}if(o(a,0))return y(t,s);t instanceof Date&&(t=g(t,s.date1904));var i=function(e,t){var s=M(e),a=s.length,i=s[a-1].indexOf("@");if(a<4&&i>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if("number"!=typeof t)return[4,4===s.length||i>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=i>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=i>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=i>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"]}var r=t>0?s[0]:t<0?s[1]:s[2];if(-1===s[0].indexOf("[")&&-1===s[1].indexOf("["))return[a,r];if(null!=s[0].match(A)||null!=s[1].match(A)){var n=s[0].match(O),l=s[1].match(O);return E(t,n)?[a,s[0]]:E(t,l)?[a,s[1]]:[a,s[null!=n&&null!=l?2:1]]}return[a,r]}(a,t);if(o(i[1]))return y(t,s);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return S(i[1],t,s,i[0])}function D(e,t){if("number"!=typeof t){t=+t||-1;for(var s=0;s<392;++s)if(null!=d[s]){if(d[s]==e){t=s;break}}else t<0&&(t=s);t<0&&(t=391)}return d[t]=e,t}e.load=D,e._table=d,e.get_table=function(){return d},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&D(e[t],t)},e.init_table=c,e.format=T}(a),"undefined"==typeof DO_NOT_EXPORT_SSF&&(e.exports=a)},function(e,t,s){"use strict";s.r(t);var a=s(1),i=s.n(a),r=s(0);const n={theme:{section:"Theme",type:"string",display:"select",label:"Theme",values:[{Traditional:"traditional"},{Looker:"looker"},{Contemporary:"contemporary"},{"Use custom theme":"custom"}],default:"traditional",order:1},customTheme:{section:"Theme",type:"string",label:"Load custom CSS from:",default:"",order:2},layout:{section:"Theme",type:"string",display:"select",label:"Layout",values:[{Even:"fixed"},{Auto:"auto"}],default:"fixed",order:3},columnOrder:{},rowSubtotals:{section:"Table",type:"boolean",label:"Row Subtotals",display_size:"half",default:!1,order:1},colSubtotals:{section:"Table",type:"boolean",label:"Col Subtotals",display_size:"half",default:!1,order:2},spanRows:{section:"Table",type:"boolean",label:"Merge Dims",display_size:"half",default:!0,order:3},spanCols:{section:"Table",type:"boolean",label:"Merge Headers",display_size:"half",default:!0,order:4},subtotalDepth:{section:"Table",type:"number",label:"Sub Total Depth",default:1,order:5},sortColumnsBy:{section:"Table",type:"string",display:"select",label:"Sort Columns By",values:[{Pivots:"getSortByPivots"},{Measures:"getSortByMeasures"}],default:"getSortByPivots",order:6},useViewName:{section:"Table",type:"boolean",label:"Include View Name",default:!1,order:7},useHeadings:{section:"Table",type:"boolean",label:"Use Headings (non-pivots only)",default:!1,order:8},useShortName:{section:"Table",type:"boolean",label:"Use Short Name (from model)",default:!1,order:9},groupVarianceColumns:{section:"Table",type:"boolean",label:"Group Variance Columns After Pivots",default:!1,order:10},indexColumn:{section:"Dimensions",type:"boolean",label:"Use Last Field Only",default:!1,order:0},tranposeTable:{section:"Table",type:"boolean",label:"Transpose",default:!1,order:100}};exports.LookerDataTable=class{constructor(e,t,s){this.config=s,this.dimensions=[],this.measures=[],this.columns=[],this.data=[],this.subtotals_data={},this.transposed_columns=[],this.transposed_data=[],this.pivot_fields=[],this.pivots=[],this.pivot_values=[],this.variances=[],this.column_series=[],this.colspan_values={},this.rowspan_values={},this.useIndexColumn=s.indexColumn||!1,this.useHeadings=s.useHeadings||!1,this.useShortName=s.useShortName||!1,this.useViewName=s.useViewName||!1,this.addRowSubtotals=s.rowSubtotals||!1,this.addSubtotalDepth=s.subtotalDepth||this.dimensions.length-1,this.spanRows=s.spanRows,this.spanCols=s.spanCols,this.sortColsBy=s.sortColumnsBy||"getSortByPivots",this.has_totals=!1,this.has_subtotals=!1,this.has_row_totals=t.has_row_totals||!1,this.has_pivots=!1,this.has_supers=!1,this.transposeTable=s.tranposeTable;this.checkPivotsAndSupermeasures(t),this.checkVarianceCalculations(),this.addDimensions(t,0),this.addMeasures(t,0),this.buildIndexColumn(t),this.checkSubtotalsData(t),this.buildRows(e),this.addColumnSeries(),this.buildTotals(t),this.updateRowSpanValues(),this.config.rowSubtotals&&this.addSubTotals(s.subtotalDepth),this.config.colSubtotals&&2==this.pivot_fields.length&&this.addColumnSubTotals(),this.addVarianceColumns(),this.sortColumns(),this.applyFormatting(),this.transposeTable&&(this.transposeColumns(),this.transposeRows()),this.validateConfig()}static getCoreConfigOptions(){return n}getConfigOptions(){for(var e=n,t=0;t<this.dimensions.length;t++)e["label|"+this.dimensions[t].name]={section:"Dimensions",type:"string",label:this.dimensions[t].label,default:this.dimensions[t].label,order:10*t+1},e["heading|"+this.dimensions[t].name]={section:"Dimensions",type:"string",label:"Heading",default:"",order:10*t+2},e["hide|"+this.dimensions[t].name]={section:"Dimensions",type:"boolean",label:"Hide",display_size:"third",default:!1,order:10*t+3};for(t=0;t<this.measures.length;t++){e["label|"+this.measures[t].name]={section:"Measures",type:"string",label:this.measures[t].label_short||this.measures[t].label,default:this.measures[t].label_short||this.measures[t].label,order:100+10*t+1},e["heading|"+this.measures[t].name]={section:"Measures",type:"string",label:"Heading for "+(this.measures[t].label_short||this.measures[t].label),default:"",order:100+10*t+2},e["style|"+this.measures[t].name]={section:"Measures",type:"string",label:"Style",display:"select",values:[{Normal:"normal"},{"Black/Red":"black_red"},{Subtotal:"subtotal"},{Hidden:"hide"}],order:100+10*t+3};var s=[];if(this.measures[t].can_pivot){for(var a=[],i=0;i<this.pivot_fields.length;i++){if(1===this.pivot_fields.length||1===i||this.config.colSubtotals)(l={})["By "+this.pivot_fields[i]]=this.pivot_fields[i],a.push(l)}s=s.concat(a)}for(var r=0;r<this.measures.length;r++){var l,o=this.measures[t].can_pivot===this.measures[r].can_pivot||this.has_row_totals&&!this.measures[r].is_table_calculation;if(t!=r&&o)(l={})["vs. "+this.measures[r].label]=this.measures[r].name,s.push(l)}s.unshift({"(none)":"no_variance"}),e["comparison|"+this.measures[t].name]={section:"Measures",type:"string",label:"Comparison",display:"select",values:s,order:100+10*t+5},e["switch|"+this.measures[t].name]={section:"Measures",type:"boolean",label:"Switch",display_size:"third",default:!1,order:100+10*t+6},e["var_num|"+this.measures[t].name]={section:"Measures",type:"boolean",label:"Var #",display_size:"third",default:!1,order:100+10*t+7},e["var_pct|"+this.measures[t].name]={section:"Measures",type:"boolean",label:"Var %",display_size:"third",default:!1,order:100+10*t+8}}return e}checkPivotsAndSupermeasures(e){for(var t=0;t<e.fields.pivots.length;t++){var s=e.fields.pivots[t].name;this.pivot_fields.push(s),this.pivots.push(e.fields.pivots[t])}void 0!==e.pivots&&(this.pivot_values=e.pivots,this.has_pivots=!0),void 0!==e.fields.supermeasure_like&&(this.has_supers=!0)}checkVarianceCalculations(){var e=this.config;Object.keys(e).forEach(t=>{if(t.startsWith("comparison")){var s=t.split("|")[1];if(this.pivot_fields.includes(e[t]))var a="by_pivot";else a="vs_measure";if(void 0!==e["switch|"+s])if(e["switch|"+s])var i=!0;else i=!1;this.variances.push({baseline:s,comparison:e[t],type:a,reverse:i})}})}applyVisToolsTags(e,t){if(void 0!==e.tags)for(var s=0;s<e.tags.length;s++){var a=e.tags[s].split(":");"vis-tools"===a[0]&&("heading"===a[1]?t.heading=a[2]:"short_name"===a[1]?t.short_name=a[2]:"unit"===a[1]&&(t.unit=a[2]))}}addDimensions(e,t){for(var s=0;s<e.fields.dimension_like.length;s++){var a=new r.ModelDimension({table:this,name:e.fields.dimension_like[s].name,type:"dimension",view:e.fields.dimension_like[s].view_label||"",label:e.fields.dimension_like[s].label_short||e.fields.dimension_like[s].label,is_numeric:e.fields.dimension_like[s].is_numeric});this.applyVisToolsTags(e.fields.dimension_like[s],a),this.dimensions.push(a);var i=new r.Column(a.name,this,a);i.idx=t,i.levels=Object(r.newArray)(e.fields.pivots.length,""),i.field=e.fields.dimension_like[s],i.pivoted=!1,i.super=!1,i.sort_by_measure_values=[0,t,...Object(r.newArray)(this.pivot_fields.length,0)],i.sort_by_pivot_values=[0,...Object(r.newArray)(this.pivot_fields.length,0),t],void 0!==this.config["style|"+a.name]&&("hide"===this.config["style|"+a.name]?this.hide=!0:this.hide=!1),this.columns.push(i),t+=10}}addMeasures(e,t){for(var s=this.config,a=0;a<e.fields.measure_like.length;a++){var i=new r.ModelMeasure({table:this,name:e.fields.measure_like[a].name,view:e.fields.measure_like[a].view_label||"",label:e.fields.measure_like[a].label_short||e.fields.measure_like[a].label,is_numeric:e.fields.measure_like[a].is_numeric,value_format:e.fields.measure_like[a].value_format||"",is_table_calculation:void 0!==e.fields.measure_like[a].is_table_calculation,can_pivot:!0,is_turtle:e.fields.measure_like[a].is_turtle,calculation_type:e.fields.measure_like[a].type});this.applyVisToolsTags(e.fields.measure_like[a],i),this.measures.push(i)}if(this.has_pivots)for(var n=0;n<this.pivot_values.length;n++)for(a=0;a<this.measures.length;a++){if("$$$_row_total_$$$"!=this.pivot_values[n].key||"$$$_row_total_$$$"==this.pivot_values[n].key&&0==this.measures[a].is_table_calculation){for(var l=this.pivot_values[n].key,o=l+"."+this.measures[a].name,h=[],u=[],c=0;c<e.fields.pivots.length;c++){var d=e.fields.pivots[c].name;h.push(this.pivot_values[n].data[d]),u.push(this.pivot_values[n].sort_values[d])}var v=this.measures[a];(p=new r.Column(o,this,v)).idx=t,p.levels=h,p.field=e.fields.measure_like[a],p.pivoted=!0,p.super=!1,p.pivot_key=l,"$$$_row_total_$$$"!==this.pivot_values[n].key?(p.sort_by_measure_values=[1,a,...u],p.sort_by_pivot_values=[1,...u,t]):(p.super=!0,p.sort_by_measure_values=[2,a,...Object(r.newArray)(this.pivot_fields.length,0)],p.sort_by_pivot_values=[2,...Object(r.newArray)(this.pivot_fields.length,0),t]),this.columns.push(p),t+=10}}else for(a=0;a<this.measures.length;a++){(p=new r.Column(this.measures[a].name,this,this.measures[a])).idx=t;try{void 0!==s.columnOrder[p.id]?p.pos=s.columnOrder[p.id]:p.pos=t}catch{p.pos=t}p.field=e.fields.measure_like[a],p.pivoted=!1,p.super=!1,p.sort_by_measure_values=[1,p.pos],p.sort_by_pivot_values=[1,p.pos],this.columns.push(p),t+=10}if(void 0!==e.fields.supermeasure_like)for(var f=0;f<e.fields.supermeasure_like.length;f++){var p,m=new r.ModelMeasure({table:this,name:e.fields.supermeasure_like[f].name,view:"",label:e.fields.supermeasure_like[f].label,is_numeric:e.fields.supermeasure_like[f].is_numeric,value_format:e.fields.supermeasure_like[f].value_format,is_table_calculation:e.fields.supermeasure_like[f].is_table_calculation,calculation_type:e.fields.supermeasure_like[f].type,can_pivot:!1});this.applyVisToolsTags(e.fields.supermeasure_like[f],m),this.measures.push(m),(p=new r.Column(m.name,this,m)).idx=t,p.levels=Object(r.newArray)(e.fields.pivots.length,""),p.field=e.fields.supermeasure_like[f],p.pivoted=!1,p.super=!0,p.sort_by_measure_values=[2,t,...Object(r.newArray)(this.pivot_fields.length,1)],p.sort_by_pivot_values=[2,...Object(r.newArray)(this.pivot_fields.length,1),t],this.columns.push(p),t+=10}}buildIndexColumn(e){var t=new r.Column("$$$_index_$$$",this,this.dimensions[this.dimensions.length-1]);t.levels=Object(r.newArray)(e.fields.pivots.length,""),t.sort_by_measure_values=[-1,0,...Object(r.newArray)(this.pivot_fields.length,0)],t.sort_by_pivot_values=[-1,...Object(r.newArray)(this.pivot_fields.length,0),0],this.columns.push(t)}checkSubtotalsData(e){void 0!==e.subtotals_data&&(this.has_subtotals=!0,void 0!==e.subtotals_data[this.addSubtotalDepth]&&e.subtotals_data[this.addSubtotalDepth].forEach(e=>{var t=new r.Row("subtotal");t.$$$__grouping__$$$=e.$$$__grouping__$$$;var s=["Subtotal"];t.$$$__grouping__$$$.forEach(t=>{s.push(e[t].value)}),t.id=s.join("|"),this.columns.forEach(s=>{s.pivoted?t.data[s.id]=e[s.parent.name][s.pivot_key]:t.data[s.id]=e[s.id],void 0!==t.data[s.id]&&(void 0===t.data[s.id].cell_style?t.data[s.id].cell_style=["total","subtotal"]:isSubtotal.data[s.id].cell_style.concat(["total","subtotal"]),void 0!==s.parent.style&&(t.data[s.id].cell_style=t.data[s.id].cell_style.concat(s.parent.style)),null===t.data[s.id].value&&(t.data[s.id].rendered=""))}),this.subtotals_data[t.id]=t}))}buildRows(e){for(var t=0;t<e.length;t++){for(var s=new r.Row("line_item"),a=0;a<this.columns.length;a++){var i=this.columns[a];if(i.pivoted?s.data[i.id]=e[t][i.parent.name][i.pivot_key]:s.data[i.id]=e[t][i.id],void 0!==s.data[i.id]&&(void 0===s.data[i.id].cell_style&&(s.data[i.id].cell_style=[]),void 0!==i.parent.style&&(s.data[i.id].cell_style=s.data[i.id].cell_style.concat(i.parent.style)),null===s.data[i.id].value&&(s.data[i.id].rendered=""),i.parent.is_turtle)){var n=new r.CellSeries({column:i,row:s,sort_value:s.data[i.id].sort_value,series:{keys:s.data[i.id]._parsed.keys,values:s.data[i.id]._parsed.values}});s.data[i.id].value=n,s.data[i.id].rendered=n.to_string()}}for(var l=[],o=0;o<this.dimensions.length;o++)l.push(e[t][this.dimensions[o].name].value);s.id=l.join("|");var h=this.dimensions[this.dimensions.length-1].name;s.data.$$$_index_$$$={value:e[t][h].value,rendered:this.getRenderedFromHtml(e[t][h]),html:e[t][h].html,cell_style:["indent"]},s.sort=[0,0,t],this.data.push(s)}}applyFormatting(){for(var e=this.config,t=0;t<this.columns.length;t++){var s=this.columns[t];if(void 0!==e["style|"+s.id]&&"black_red"==e["style|"+s.id])for(var a=0;a<this.data.length;a++){var i=this.data[a];i.data[s.id].value<0&&i.data[s.id].cell_style.push("red")}}}getColumnById(e){var t={};return this.columns.forEach(s=>{e===s.id&&(t=s)}),t}getMeasureByName(e){var t={};return this.measures.forEach(s=>{e===s.name&&(t=s)}),t}updateRowSpanValues(){var e={};for(a=0;a<this.dimensions.length;a++)e[this.dimensions[a].name]=1;for(var t=this.data.length-1;t>=0;t--){var s=this.data[t];if("line_item"===s.type){this.rowspan_values[s.id]={};for(var a=0;a<this.dimensions.length;a++){var i=this.dimensions[a].name,r=this.data[t].data[i].value;if(t>0)var n=this.data[t-1].data[i].value;if(!(t>0&&r==n)){for(var l=a;l<this.dimensions.length;l++){var o=this.dimensions[l].name;this.rowspan_values[s.id][o]=e[o],e[o]=1}break}this.rowspan_values[s.id][this.dimensions[a].name]=-1,e[i]+=1}}else for(a=0;a<this.dimensions.length;a++)e[this.dimensions[a].name]=1}}sortData(){this.data.sort((e,t)=>{for(var s=e.sort.length,a=0;a<s;a++){if(e.sort[a]>t.sort[a])return 1;if(e.sort[a]<t.sort[a])return-1}return-1}),this.updateRowSpanValues()}sortColumns(){if(this.columns.sort((e,t)=>{for(var s=this.sortColsBy,a=e[s]().length,i=0;i<a;i++){if(e[s]()[i]>t[s]()[i])return 1;if(e[s]()[i]<t[s]()[i])return-1}return-1}),this.useIndexColumn)var e=this.columns.filter(e=>"measure"==e.parent.type||"$$$_index_$$$"===e.id).filter(e=>!e.hide);else e=this.columns.filter(e=>"$$$_index_$$$"!==e.id).filter(e=>!e.hide);this.setColSpans(e)}addSubTotals(){for(var e=this.addSubtotalDepth,t=[],s=[],a=0;a<this.data.length;a++){var n=this.data[a];if("total"!==n.type){for(var l=[],o=0;o<e;o++){var h=this.dimensions[o].name;l.push(n.data[h].value)}l.join("|")!==s.join("|")&&(t.push(l),s=l),n.sort=[0,t.length-1,a]}}for(var u=this.dimensions[0].name,c=0;c<this.dimensions.length;c++)if(!this.dimensions[c].hide){u=this.dimensions[c].name;break}for(var d=0;d<t.length;d++){var v=new r.Row("subtotal");v.id="Subtotal|"+t[d].join("|");for(c=0;c<this.columns.length;c++){var f=this.columns[c];if(v.data[f.id]={cell_style:["total","subtotal"]},"$$$_index_$$$"===f.id||f.id===u){var p=t[d].join(" | ");v.data[f.id].value=p}if("measure"==f.parent.type)if(Object.entries(this.subtotals_data).length>0)v.data[f.id]={...v.data[f.id],...this.subtotals_data[v.id].data[f.id]};else{if(f.pivoted)var m=[f.pivot_key,f.parent.name].join(".");else m=f.id;for(var _=0,g=0,b="",y=0;y<this.data.length;y++){var $=this.data[y];if("line_item"==$.type&&$.sort[1]==d){var w=$.data[m].value;Number.isFinite(w)&&(_+=w,g++)}}"average"===f.parent.calculation_type&&g>0&&(_/=g),_&&(b=""===f.parent.value_format?_.toString():i.a.format(f.parent.value_format,_)),"string"===f.parent.calculation_type&&(_="",b="");var k={value:_,rendered:b,cell_style:["subtotal","total"]};v.data[m]=k}}v.sort=[0,d,9999],this.data.push(v)}this.sortData(),this.has_subtotals=!0}addColumnSubTotals(){for(var e="",t={},s=[],a=[],n=this.pivot_fields[0],l=0;l<this.pivot_values.length;l++){var o=this.pivot_values[l].data[n];null!==o&&a.push(o)}a=[...new Set(a)];for(l=0;l<a.length;l++)for(var h=a[l],u=[0,""],c=null,d=0;d<this.measures.length;d++)if(this.measures[d].can_pivot){for(var v=this.measures[d].name,f={parent:this.measures[d],field:v,pivot:h,measure_idx:d,pivot_idx:l,columns:[],id:["$$$_subtotal_$$$",h,v].join("."),after:""},p=0;p<this.columns.length;p++){(_=this.columns[p]).pivoted&&_.levels[0]==h&&(_.parent.name==v&&f.columns.push(_.id),_.levels[0]==h&&p>u[0]&&(u=[p,_.id]))}h!=e&&(t[h]=u[1],c=null),f.after=c||t[h],e=h,c=f.id,s.push(f)}for(var m=0;m<s.length;m++){var _,g=s[m],b=this.measures[g.measure_idx];(_=new r.Column(g.id,this,b)).levels=[g.pivot,"Subtotal"],_.field={name:g.field},_.sort_by_measure_values=[1,g.measure_idx,..._.levels];var y=[..._.levels];"string"==typeof y[y.length-1]?y[y.length-1]="ZZZZ":y[y.length-1]=9999,_.sort_by_pivot_values=[1,...y,1e4+m],_.pivoted=!0,_.subtotal=!0,_.pivot_key=[g.pivot,"$$$_subtotal_$$$"].join("|"),this.columns.push(_)}this.sortColumns();for(var $=0;$<this.data.length;$++){var w=this.data[$];for(m=0;m<s.length;m++){g=s[m];for(var k=0,M=0;M<g.columns.length;M++){var x=g.columns[M];k+=w.data[x].value}w.data[g.id]={value:k,rendered:""===g.parent.value_format?k.toString():i.a.format(g.parent.value_format,k),align:"right",cell_style:["subtotal"]},["subtotal","total"].includes(w.type)&&w.data[g.id].cell_style.push("total")}}return s}calculateVariance(e,t,s,a,r){for(var n=0;n<this.data.length;n++){var l=this.data[n],o=l.data[a.id].value,h=l.data[r.id].value;if("absolute"===s)var u={value:o-h,rendered:""===e?(o-h).toString():i.a.format(e,o-h),cell_style:[]};else{var c=(o-h)/Math.abs(h);if(isFinite(c))u={value:c,rendered:i.a.format("#0.00%",c),cell_style:[]};else var u={value:null,rendered:"∞",cell_style:[]}}"total"!=l.type&&"subtotal"!=l.type||u.cell_style.push("total"),"subtotal"===l.type&&u.cell_style.push("subtotal"),u.value<0&&u.cell_style.push("red"),l.data[t]=u}}createVarianceColumn(e){var t=this.config;if(t.colSubtotals||!e.variance.baseline.startsWith("$$$_subtotal_$$$")){var s=["$$$_variance_$$$",e.calc,e.variance.baseline,e.variance.comparison].join("|"),a=this.getColumnById(e.variance.baseline),i=this.getColumnById(e.variance.comparison),n=new r.Column(s,this,a.parent);"absolute"===e.calc?(n.variance_type="absolute",n.idx=a.idx+1,n.pos=a.pos+1,n.sort_by_measure_values=a.sort_by_measure_values.concat(1),n.sort_by_pivot_values=a.sort_by_pivot_values.concat(1),n.hide=!t["var_num|"+a.parent.name]):(n.variance_type="percentage",n.idx=a.idx+2,n.pos=a.pos+2,n.sort_by_measure_values=a.sort_by_measure_values.concat(2),n.sort_by_pivot_values=a.sort_by_pivot_values.concat(2),n.unit="%",n.hide=!t["var_pct|"+a.parent.name]),a.sort_by_measure_values.length<n.sort_by_measure_values.length&&a.sort_by_measure_values.push(0),a.sort_by_pivot_values.length<n.sort_by_pivot_values.length&&a.sort_by_pivot_values.push(0),void 0!==t.columnOrder[n.id]&&(n.pos=t.columnOrder[n.id]),n.field={name:s},n.pivoted=a.pivoted,n.super=a.super,n.pivot_key="",n.levels=a.levels,t.groupVarianceColumns&&("getSortByPivots"===t.sortColumnsBy&&(n.sort_by_pivot_values[0]=1.5),1===a.levels.length?n.levels=["Variance"]:n.levels=["Variance",a.levels[1]]),this.columns.push(n),e.variance.reverse?this.calculateVariance(a.parent.value_format,s,e.calc,i,a):this.calculateVariance(a.parent.value_format,s,e.calc,a,i)}else console.log("Cannot calculate variance of column subtotals if subtotals disabled.")}addVarianceColumns(){var e=[],t=["absolute","percent"];Object.keys(this.variances).forEach(s=>{var a=this.variances[s];if("no_variance"!==a.comparison)if("vs_measure"===a.type)this.has_pivots?this.pivot_values.forEach(s=>{s.is_total||t.forEach(t=>{e.push({calc:t,variance:{baseline:[s.key,a.baseline].join("."),comparison:[s.key,a.comparison].join("."),reverse:a.reverse,type:a.type}})})}):t.forEach(t=>{e.push({variance:a,calc:t})});else if("by_pivot"===a.type)if(1===this.pivot_fields.length||this.pivot_fields[1]===a.comparison)this.pivot_values.slice(1).forEach((s,i)=>{t.forEach(t=>{s.is_total||e.push({calc:t,variance:{baseline:[s.key,a.baseline].join("."),comparison:[this.pivot_values[i].key,a.baseline].join("."),reverse:a.reverse,type:a.type}})})});else{var i=[];this.pivot_values.forEach(e=>{if(!e.is_total){var t=e.data[this.pivot_fields[0]];i.includes(t)||i.push(t)}}),i.slice(1).forEach((s,r)=>{t.forEach(t=>{e.push({calc:t,variance:{baseline:["$$$_subtotal_$$$",s,a.baseline].join("."),comparison:["$$$_subtotal_$$$",i[r],a.baseline].join("."),reverse:a.reverse,type:a.type}})})})}}),e.forEach(e=>{this.createVarianceColumn(e)})}addColumnSeries(){this.columns.forEach(e=>{var t=[],s=[],a=[];this.data.forEach(i=>{t.push(i.id),s.push(i.data[e.id].value),a.push(i.type)});var i=new r.ColumnSeries({column:e,is_numeric:e.parent.is_numeric,series:{keys:t,values:s,types:a}});e.series=i,this.column_series.push(i)})}buildTotals(e){if(void 0!==e.totals_data){if(void 0!==e.truncated)var t=!0;else t=!1;for(var s=e.totals_data,a=this.dimensions[0].name,n=0;n<this.dimensions.length;n++)if(!this.dimensions[n].hide){a=this.dimensions[n].name;break}for(var l=new r.Row("total"),o=new r.Row("line_item"),h=0;h<this.columns.length;h++){var u=this.columns[h],c=null;if(l.id="Total",o.id="Others",l.data[u.id]={value:"",cell_style:["total"]},o.data[u.id]={value:"",cell_style:[]},"measure"==u.parent.type){if(1==u.pivoted)var d=s[u.parent.name][u.pivot_key];else d=s[u.id];if(void 0===d.rendered&&void 0!==d.html&&(d.rendered=this.getRenderedFromHtml(d)),t&&(["sum","count_distinct","count"].includes(u.parent.calculation_type)?c=d.value-u.series.series.sum:"average"===u.parent.calculation_type&&(c=(d.value+u.series.series.avg)/2)),d.cell_style=["total"],l.data[u.id]=d,void 0!==l.data[u.id].links&&l.data[u.id].links.forEach(e=>{e.type="measure_default"}),t&&c){var v=""===u.parent.value_format?c.toString():i.a.format(u.parent.value_format,c);o.data[u.id]={value:c,rendered:v}}}}l.data.$$$_index_$$$.value="TOTAL",l.data[a].value="TOTAL",l.sort=[1,0,0],t&&(o.data.$$$_index_$$$.value="Others",o.data[a].value="Others",o.sort=[1,-1,-1]),this.data.push(l),t&&this.data.push(o),this.has_totals=!0,this.sortData()}}getRenderedFromHtml(e){var t=new DOMParser;if(void 0===e.html||["undefined",""].includes(e.html))s=e.value;else try{var s=t.parseFromString(e.html,"text/html").documentElement.textContent}catch(t){var s=e.html}return s}transposeColumns(){this.transposed_columns=[];var e=Object(r.newArray)(this.dimensions.length,1),t={align:"left",type:"transposed_table_index",is_table_calculation:!1},s={align:"right",type:"transposed_table_measure",is_table_calculation:!1};this.useHeadings&&!this.has_pivots&&((i=new r.Column("header",this,t)).labels=["Header","",""],i.colspans=e,i.type="measure",this.transposed_columns.push(i));"getSortByPivots"===this.sortColsBy?(this.pivots.forEach(s=>{var a=new r.Column(s.name,this,t);a.labels=[s.label_short,"",""],a.colspans=e,a.type="dimension",a.align="left",this.transposed_columns.push(a)}),(i=new r.Column("measure",this,t)).labels=["Meaure","",""],i.colspans=e,i.type="measure",i.align="left",this.transposed_columns.push(i)):((i=new r.Column("measure",this,t)).labels=["Meaure","",""],i.colspans=e,i.type="measure",i.align="left",this.transposed_columns.push(i),this.pivots.forEach(s=>{var a=new r.Column(s.name,this,t);a.labels=[s.label_short,"",""],a.colspans=e,a.type="dimension",a.align="left",this.transposed_columns.push(a)}));for(var a=0;a<this.data.length;a++){var i,n=this.data[a];if("line_item"===n.type){var l=[],o=[];this.dimensions.forEach(e=>{this.spanRows?l.push(this.rowspan_values[n.id][e.name]):l.push(1),o.push(n.data[e.name].value)})}else if("subtotal"===n.type)l=e,o=["Subtotal"].concat(Object(r.newArray)(this.dimensions.length-1,""));else if("total"===n.type)l=e,o=["TOTAL"].concat(Object(r.newArray)(this.dimensions.length-1,""));(i=new r.Column(n.id,this,s)).transposed=!0,i.colspans=l,i.labels=o,i.align="right",this.transposed_columns.push(i)}}transposeRows(){this.columns.filter(e=>"measure"===e.parent.type).forEach(e=>{var t={};this.data.forEach(s=>{void 0!==s.data[e.id]?(t[s.id]=s.data[e.id],t[s.id].align="right",void 0!==t[s.id].cell_style?t[s.id].cell_style.push("transposed"):t[s.id].cell_style=["transposed"]):console.log("row data does not exist for",e.id)});var s=e.parent.heading,a="heading|"+e.parent.name;if(void 0!==this.config[a]&&(s=this.config[a]?this.config[a]:s),t.header={value:s,cell_style:[]},e.subtotal&&t.header.cell_style.push("subtotal"),"getSortByPivots"===this.sortColsBy)var i=this.pivots.length;else i=0;this.useHeadings&&i++,t.measure={value:e.getLabel(i),cell_style:[]},e.subtotal&&t.measure.cell_style.push("subtotal"),e.parent.style.includes("subtotal")&&t.measure.cell_style.push("subtotal"),this.pivot_fields.forEach((s,a)=>{t[s]={value:e.levels[a],cell_style:[]},e.subtotal&&t[s].cell_style.push("subtotal")});var n=new r.Row("line_item");n.id=e.id,n.parent=e.parent,n.hide=e.hide,n.rowspans=e.colspans,n.data=t,this.transposed_data.push(n)})}getLevels(){var e=[];return this.transposeTable?e=this.dimensions:(this.useHeadings&&!this.has_pivots&&e.push("headers level"),"getSortByPivots"===this.sortColsBy?(this.pivots.forEach(t=>{e.push(t.name)}),e.push("measures level")):(e.push("measures level"),this.pivots.forEach(t=>{e.push(t.name)}))),e}setColSpans(e){for(var t=this.config,s=[],a=[],i=[],n=e.length-1;n>=0;n--){var l=e.length-1-n;if("getSortByPivots"===this.sortColsBy?s[l]=[...e[n].levels,e[n].field.name]:s[l]=[e[n].field.name,...e[n].levels],this.useHeadings&&!this.has_pivots){var o=e[n].parent.heading,h="heading|"+e[n].parent.name;void 0!==t[h]&&(o=t[h]?t[h]:o),s[l].unshift(o)}a[n]=Object(r.newArray)(s[l].length,1)}if(this.spanCols){i=Object(r.newArray)(s[0].length,1);for(var u=0;u<s.length;u++)for(var c=s[u].length-1,d=0;d<c;d++){var v=s[u][d];if(u<s.length-1)var f=s[u+1][d];if(!(u<s.length-1&&v==f)){for(var p=d;p<c;p++)a[u][p]=i[p],i[p]=1;break}a[u][d]=-1,i[d]+=1}if("getSortByPivots"===this.sortColsBy)var m=this.pivot_fields.length+1;else m=0;for(u=s.length-1;u>=0;u--){v=s[u][m];if(u>0)var _=s[u-1][m];u>0&&v==_?(a[u][m]=-1,i[m]+=1):(a[u][m]=i[m],i[m]=1)}a.reverse()}return e.forEach((e,t)=>{e.colspans=a[t],this.colspan_values[e.id]=a[t]}),e}getTableColumnGroups(){var e=[],t=[],s=[];this.transposeTable?this.transposed_columns.forEach(a=>{"transposed_table_index"===a.parent.type?e.push({id:a.id}):"transposed_table_measure"===a.parent.type&&"Total"!==a.id?t.push({id:a.id}):"transposed_table_measure"===a.parent.type&&"Total"===a.id&&s.push({id:a.id})}):this.columns.forEach(a=>{"dimension"!==a.parent.type||this.useIndexColumn||"$$$_index_$$$"===a.id||a.hide?"dimension"===a.parent.type&&this.useIndexColumn&&"$$$_index_$$$"===a.id?e.push({id:a.id}):"measure"!==a.parent.type||a.super||a.hide?"measure"===a.parent.type&&a.super&&!a.hide&&s.push({id:a.id}):t.push({id:a.id}):e.push({id:a.id})})}getTableHeaders(e){if(this.transposeTable)return this.transposed_columns.filter(t=>t.colspans[e]>0);if(this.useIndexColumn)var t=this.columns.filter(e=>"measure"==e.parent.type||"$$$_index_$$$"===e.id).filter(e=>!e.hide);else t=this.columns.filter(e=>"$$$_index_$$$"!==e.id).filter(e=>!e.hide);return t=this.setColSpans(t).filter(t=>t.colspans[e]>0)}getDataRows(){return this.transposeTable?this.transposed_data.filter(e=>!e.hide):this.data}getTableColumns(e){if(this.transposeTable){(t=this.transposed_columns.filter(e=>!0)).forEach((t,s)=>{t.rowspan=1,"transposed_table_index"===t.parent.type&&void 0!==e.rowspans[s]&&(t.rowspan=this.colspan_values[e.id][s])}),t=t.filter(e=>e.rowspan>0)}else{if(this.useIndexColumn)var t=this.columns.filter(e=>"measure"==e.parent.type||"$$$_index_$$$"===e.id).filter(e=>!e.hide);else var t=this.columns.filter(e=>"$$$_index_$$$"!==e.id).filter(e=>!e.hide);if(!this.useIndexColumn&&this.spanRows){for(var s=0;s<t.length;s++)t[s].rowspan=1,"line_item"===e.type&&this.rowspan_values[e.id][t[s].id]>0&&(t[s].rowspan=this.rowspan_values[e.id][t[s].id]);"line_item"===e.type&&(t=t.filter(t=>"measure"==t.parent.type||this.rowspan_values[e.id][t.id]>0))}}return t}moveColumns(e,t,s){var a=this.config;if(e!=t){for(var i=t-e,r=a.columnOrder,n=0;n<this.columns.length;n++){var l=this.columns[n];"measure"!=l.parent.type||l.super||(l.pos>=e&&l.pos<e+10?l.pos+=i:l.pos>=t&&l.pos<e?l.pos+=10:l.pos>=e+10&&l.pos<t+10&&(l.pos-=10),r[l.id]=l.pos)}s(r)}}validateConfig(){["traditional","looker","contemporary","custom"].includes(this.config.theme)||(this.config.theme="traditional"),["fixed","auto"].includes(this.config.layout)||(this.config.layout="fixed"),void 0===this.config.transposeTable&&(this.config.transposeTable=!1),Object.entries(this.config).forEach(e=>{"false"===e[1]?e[1]=!1:"true"===e[1]&&(e[1]=!0)})}getSimpleJson(){var e=[];return this.data.forEach(t=>{if("line_item"===t.type){var s={};this.columns.forEach(e=>{s[e.id]=t.data[e.id].value}),e.push(s)}}),e}}}]);
//# sourceMappingURL=looker_data_table.js.map